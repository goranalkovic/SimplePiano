var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function r(e){return e()}function o(){return Object.create(null)}function s(e){e.forEach(r)}function a(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(e,t,n){const r=t.subscribe(n);e.$$.on_destroy.push(r.unsubscribe?()=>r.unsubscribe():r)}function u(e,t,n){if(e){const r=c(e,t,n);return e[0](r)}}function c(e,t,r){return e[1]?n({},n(t.$$scope.ctx,e[1](r?r(t):{}))):t.$$scope.ctx}function d(e,t,r,o){return e[1]?n({},n(t.$$scope.changed||{},e[1](o?o(r):{}))):t.$$scope.changed||{}}let f="undefined"!=typeof window?()=>window.performance.now():()=>Date.now(),m=e=>requestAnimationFrame(e);const v=new Set;let p,$=!1;function h(){v.forEach(e=>{e[0](f())||(v.delete(e),e[1]())}),($=v.size>0)&&m(h)}function g(e){let t;return $||($=!0,m(h)),{promise:new Promise(n=>{v.add(t=[e,n])}),abort(){v.delete(t)}}}function y(e,t){e.appendChild(t)}function b(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function w(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function x(e){return document.createElement(e)}function _(e){return document.createTextNode(e)}function S(){return _(" ")}function T(){return _("")}function A(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function M(e){return function(t){return t.preventDefault(),e.call(this,t)}}function V(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function D(e,t){t=""+t,e.data!==t&&(e.data=t)}function C(e,t,n){e.style.setProperty(t,n)}function O(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}}function I(e,t,n){e.classList[n?"add":"remove"](t)}let q,E=0,j={};function F(e,t,n,r,o,s,a,i=0){const l=16.666/r;let u="{\n";for(let e=0;e<=1;e+=l){const r=t+(n-t)*s(e);u+=100*e+`%{${a(r,1-r)}}\n`}const c=u+`100% {${a(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(c)}_${i}`;if(!j[d]){if(!p){const e=x("style");document.head.appendChild(e),p=e.sheet}j[d]=!0,p.insertRule(`@keyframes ${d} ${c}`,p.cssRules.length)}const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${d} ${r}ms linear ${o}ms 1 both`,E+=1,d}function N(e,t){e.style.animation=(e.style.animation||"").split(", ").filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")).join(", "),t&&!--E&&m(()=>{if(E)return;let e=p.cssRules.length;for(;e--;)p.deleteRule(e);j={}})}function P(e,t){const n=e.getBoundingClientRect();if(t.left!==n.left||t.top!==n.top){const r=getComputedStyle(e),o="none"===r.transform?"":r.transform;e.style.transform=`${o} translate(${t.left-n.left}px, ${t.top-n.top}px)`}}function K(e){q=e}function R(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const B=[],U=[],L=[],G=[],z=Promise.resolve();let H,J=!1;function W(e){L.push(e)}function Z(e){G.push(e)}function Q(){const e=new Set;do{for(;B.length;){const e=B.shift();K(e),Y(e.$$)}for(;U.length;)U.pop()();for(let t=0;t<L.length;t+=1){const n=L[t];e.has(n)||(n(),e.add(n))}L.length=0}while(B.length);for(;G.length;)G.pop()();J=!1}function Y(e){e.fragment&&(e.update(e.dirty),s(e.before_update),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(W))}function X(e,t,n){e.dispatchEvent(function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(`${t?"intro":"outro"}${n}`))}const ee=new Set;let te;function ne(){te={remaining:0,callbacks:[]}}function re(){te.remaining||s(te.callbacks)}function oe(e,t){e&&e.i&&(ee.delete(e),e.i(t))}function se(e,t,n){if(e&&e.o){if(ee.has(e))return;ee.add(e),te.callbacks.push(()=>{ee.delete(e),n&&(e.d(1),n())}),e.o(t)}}function ae(n,r,o,i){let l=r(n,o),u=i?0:1,c=null,d=null,m=null;function v(){m&&N(n,m)}function p(e,t){const n=e.b-u;return t*=Math.abs(n),{a:u,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function $(r){const{delay:o=0,duration:a=300,easing:i=t,tick:$=e,css:h}=l,y={start:f()+o,b:r};r||(y.group=te,te.remaining+=1),c?d=y:(h&&(v(),m=F(n,u,r,a,o,i,h)),r&&$(0,1),c=p(y,a),W(()=>X(n,r,"start")),g(e=>{if(d&&e>d.start&&(c=p(d,a),d=null,X(n,c.b,"start"),h&&(v(),m=F(n,u,c.b,c.duration,0,i,l.css))),c)if(e>=c.end)$(u=c.b,1-u),X(n,c.b,"end"),d||(c.b?v():--c.group.remaining||s(c.group.callbacks)),c=null;else if(e>=c.start){const t=e-c.start;u=c.a+c.d*i(t/c.duration),$(u,1-u)}return!(!c&&!d)}))}return{run(e){a(l)?(H||(H=Promise.resolve()).then(()=>{H=null}),H).then(()=>{l=l(),$(e)}):$(e)},end(){v(),c=d=null}}}function ie(e,t){se(e,1,()=>{t.delete(e.key)})}function le(e,t){e.f(),ie(e,t)}function ue(e,t,n,r,o,s,a,i,l,u,c,d){let f=e.length,m=s.length,v=f;const p={};for(;v--;)p[e[v].key]=v;const $=[],h=new Map,g=new Map;for(v=m;v--;){const e=d(o,s,v),i=n(e);let l=a.get(i);l?r&&l.p(t,e):(l=u(i,e)).c(),h.set(i,$[v]=l),i in p&&g.set(i,Math.abs(v-p[i]))}const y=new Set,b=new Set;function k(e){oe(e,1),e.m(i,c),a.set(e.key,e),c=e.first,m--}for(;f&&m;){const t=$[m-1],n=e[f-1],r=t.key,o=n.key;t===n?(c=t.first,f--,m--):h.has(o)?!a.has(r)||y.has(r)?k(t):b.has(o)?f--:g.get(r)>g.get(o)?(b.add(r),k(t)):(y.add(o),f--):(l(n,a),f--)}for(;f--;){const t=e[f];h.has(t.key)||l(t,a)}for(;m;)k($[m-1]);return $}function ce(e,t){const n={},r={},o={$$scope:1};let s=e.length;for(;s--;){const a=e[s],i=t[s];if(i){for(const e in a)e in i||(r[e]=1);for(const e in i)o[e]||(n[e]=i[e],o[e]=1);e[s]=i}else for(const e in a)o[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function de(e,t,n){-1!==e.$$.props.indexOf(t)&&(e.$$.bound[t]=n,n(e.$$.ctx[t]))}function fe(e,t,n){const{fragment:o,on_mount:i,on_destroy:l,after_update:u}=e.$$;o.m(t,n),W(()=>{const t=i.map(r).filter(a);l?l.push(...t):s(t),e.$$.on_mount=[]}),u.forEach(W)}function me(e,t){e.$$.fragment&&(s(e.$$.on_destroy),e.$$.fragment.d(t),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={})}function ve(e,t){e.$$.dirty||(B.push(e),J||(J=!0,z.then(Q)),e.$$.dirty=o()),e.$$.dirty[t]=!0}function pe(t,n,r,a,i,l){const u=q;K(t);const c=n.props||{},d=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:i,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:null};let f=!1;var m;d.ctx=r?r(t,c,(e,n)=>{d.ctx&&i(d.ctx[e],d.ctx[e]=n)&&(d.bound[e]&&d.bound[e](n),f&&ve(t,e))}):c,d.update(),f=!0,s(d.before_update),d.fragment=a(d.ctx),n.target&&(n.hydrate?d.fragment.l((m=n.target,Array.from(m.childNodes))):d.fragment.c(),n.intro&&oe(t.$$.fragment),fe(t,n.target,n.anchor),Q()),K(u)}class $e{$destroy(){me(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function he(e){var t,n,r;const o=e.$$slots.default,s=u(o,e,null);return{c(){t=x("button"),s&&s.c(),V(t,"style",e.style),V(t,"class","svelte-3qaunt"),I(t,"spaced",e.spaced),I(t,"outline",e.outline),r=A(t,"click",e.click_handler)},l(e){s&&s.l(button_nodes)},m(e,r){b(e,t,r),s&&s.m(t,null),n=!0},p(e,r){s&&s.p&&e.$$scope&&s.p(d(o,r,e,null),c(o,r,null)),n&&!e.style||V(t,"style",r.style),e.spaced&&I(t,"spaced",r.spaced),e.outline&&I(t,"outline",r.outline)},i(e){n||(oe(s,e),n=!0)},o(e){se(s,e),n=!1},d(e){e&&k(t),s&&s.d(e),r()}}}function ge(e,t,n){let{spaced:r=!1,style:o=null,outline:s=!1}=t,{$$slots:a={},$$scope:i}=t;return e.$set=(e=>{"spaced"in e&&n("spaced",r=e.spaced),"style"in e&&n("style",o=e.style),"outline"in e&&n("outline",s=e.outline),"$$scope"in e&&n("$$scope",i=e.$$scope)}),{spaced:r,style:o,outline:s,click_handler:function(t){R(e,t)},$$slots:a,$$scope:i}}class ye extends $e{constructor(e){super(),pe(this,e,ge,he,i,["spaced","style","outline"])}}const be=()=>({}),ke=()=>({});function we(e){var t,n,r,o;const s=e.$$slots.left,a=u(s,e,ke),i=e.$$slots.default,l=u(i,e,null);return{c(){t=x("div"),a&&a.c(),n=S(),r=x("div"),l&&l.c(),V(r,"class","right svelte-16m5xgj"),V(t,"class","titlebar svelte-16m5xgj")},l(e){a&&a.l(div1_nodes),l&&l.l(div0_nodes)},m(e,s){b(e,t,s),a&&a.m(t,null),y(t,n),y(t,r),l&&l.m(r,null),o=!0},p(e,t){a&&a.p&&e.$$scope&&a.p(d(s,t,e,be),c(s,t,ke)),l&&l.p&&e.$$scope&&l.p(d(i,t,e,null),c(i,t,null))},i(e){o||(oe(a,e),oe(l,e),o=!0)},o(e){se(a,e),se(l,e),o=!1},d(e){e&&k(t),a&&a.d(e),l&&l.d(e)}}}function xe(e,t,n){let{$$slots:r={},$$scope:o}=t;return e.$set=(e=>{"$$scope"in e&&n("$$scope",o=e.$$scope)}),{$$slots:r,$$scope:o}}class _e extends $e{constructor(e){super(),pe(this,e,xe,we,i,[])}}function Se(t,n=e){let r;const o=[];function s(e){if(i(t,e)){if(t=e,!r)return;o.forEach(e=>e[1]()),o.forEach(e=>e[0](t))}}return{set:s,update:function(e){s(e(t))},subscribe:function(a,i=e){const l=[a,i];return o.push(l),1===o.length&&(r=n(s)||e),a(t),()=>{const e=o.indexOf(l);-1!==e&&o.splice(e,1),0===o.length&&(r(),r=null)}}}}const Te={fluid:"FluidR3_GM",mk:"MusyngKite",fatboy:"FatBoy"},Ae={20:"⇪",65:"A",83:"S",68:"D",70:"F",71:"G",72:"H",74:"J",75:"K",76:"L",186:"Č",222:"Ć",220:"Ž",13:"↵",81:"Q",87:"W",69:"E",84:"T",90:"Z",73:"I",79:"O",80:"P",221:"Đ",8:"⌫"},Me={20:"52",65:"55",83:"57",68:"59",70:"60",71:"62",72:"64",74:"65",75:"67",76:"69",186:"71",222:"72",220:"74",13:"76",81:"54",87:"56",69:"58",84:"61",90:"63",73:"66",79:"68",80:"70",221:"73",8:"75"},Ve=Se({20:[],65:[],83:[],68:[],70:[],71:[],72:[],74:[],75:[],76:[],186:[],222:[],220:[],13:[],81:[],87:[],69:[],84:[],90:[],73:[],79:[],80:[],221:[],8:[]}),De=[.005,.395,.8,1.2],Ce=Se({20:!1,65:!1,83:!1,68:!1,70:!1,71:!1,72:!1,74:!1,75:!1,76:!1,186:!1,222:!1,220:!1,13:!1,81:!1,87:!1,69:!1,84:!1,90:!1,73:!1,79:!1,80:!1,221:!1,8:!1});let Oe=new AudioContext;const Ie=Se(Te.fatboy),qe=Se(0),Ee=Se(25),je=Se(0),Fe=Se(!1),Ne=Se([{name:"Set 1",instruments:[]},{name:"Set 2",instruments:[]},{name:"Set 3",instruments:[]},{name:"Set 4",instruments:[]},{name:"Set 5",instruments:[]},{name:"Set 6",instruments:[]},{name:"Set 7",instruments:[]},{name:"Set 8",instruments:[]},{name:"Set 9",instruments:[]},{name:"Set 10",instruments:[]}]);function Pe(e){var t,n;return{c(){t=x("span"),n=_(e.label),V(t,"class","label svelte-1xzgary")},m(e,r){b(e,t,r),y(t,n)},p(e,t){e.label&&D(n,t.label)},d(e){e&&k(t)}}}function Ke(t){var n,r,o,s=t.label&&Pe(t);return{c(){n=x("div"),s&&s.c(),r=S(),V(o=x("span"),"class","keyboard-key svelte-1xzgary"),I(o,"square",t.square),V(n,"class","container svelte-1xzgary")},m(e,a){b(e,n,a),s&&s.m(n,null),y(n,r),y(n,o),o.innerHTML=t.key},p(e,t){t.label?s?s.p(e,t):((s=Pe(t)).c(),s.m(n,r)):s&&(s.d(1),s=null),e.key&&(o.innerHTML=t.key),e.square&&I(o,"square",t.square)},i:e,o:e,d(e){e&&k(n),s&&s.d()}}}function Re(e,t,n){let{label:r=null,key:o,square:s=!0}=t;return e.$set=(e=>{"label"in e&&n("label",r=e.label),"key"in e&&n("key",o=e.key),"square"in e&&n("square",s=e.square)}),{label:r,key:o,square:s}}class Be extends $e{constructor(e){super(),pe(this,e,Re,Ke,i,["label","key","square"])}}function Ue(e,t,n){const r=Object.create(e);return r.kbKey=t[n],r}function Le(e){for(var t,n,r=e.keyboardKeys,o=[],s=0;s<r.length;s+=1)o[s]=Ge(Ue(e,r,s));const a=e=>se(o[e],1,()=>{o[e]=null});return{c(){t=x("div");for(var e=0;e<o.length;e+=1)o[e].c();V(t,"class","hints svelte-49eip3")},m(e,r){b(e,t,r);for(var s=0;s<o.length;s+=1)o[s].m(t,null);n=!0},p(e,n){if(e.keyboardKeys){r=n.keyboardKeys;for(var s=0;s<r.length;s+=1){const a=Ue(n,r,s);o[s]?(o[s].p(e,a),oe(o[s],1)):(o[s]=Ge(a),o[s].c(),oe(o[s],1),o[s].m(t,null))}for(ne(),s=r.length;s<o.length;s+=1)a(s);re()}},i(e){if(!n){for(var t=0;t<r.length;t+=1)oe(o[t]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)se(o[e]);n=!1},d(e){e&&k(t),w(o,e)}}}function Ge(e){var t,r=[e.kbKey];let o={};for(var s=0;s<r.length;s+=1)o=n(o,r[s]);var a=new Be({props:o});return{c(){a.$$.fragment.c()},m(e,n){fe(a,e,n),t=!0},p(e,t){var n=e.keyboardKeys?ce(r,[t.kbKey]):{};a.$set(n)},i(e){t||(oe(a.$$.fragment,e),t=!0)},o(e){se(a.$$.fragment,e),t=!1},d(e){me(a,e)}}}function ze(e){var t,n,r,o,a,i,l,u,c,d,f,m,v=e.keyboardKeys&&Le(e);return{c(){t=x("div"),n=x("label"),r=x("span"),o=_(e.title),a=S(),i=x("input"),l=S(),u=x("span"),c=_(e.formattedValue),d=S(),v&&v.c(),V(r,"class","title svelte-49eip3"),V(i,"type","range"),V(i,"min",e.min),V(i,"max",e.max),V(i,"step",e.step),V(i,"class","svelte-49eip3"),V(u,"class","value svelte-49eip3"),V(t,"class","slide-ctrl svelte-49eip3"),m=[A(i,"change",e.input_change_input_handler),A(i,"input",e.input_change_input_handler),A(i,"change",e.change_handler)]},m(s,m){b(s,t,m),y(t,n),y(n,r),y(r,o),y(n,a),y(n,i),i.value=e.value,y(n,l),y(n,u),y(u,c),y(t,d),v&&v.m(t,null),f=!0},p(e,n){f&&!e.title||D(o,n.title),e.value&&(i.value=n.value),f&&!e.min||V(i,"min",n.min),f&&!e.max||V(i,"max",n.max),f&&!e.step||V(i,"step",n.step),f&&!e.formattedValue||D(c,n.formattedValue),n.keyboardKeys?v?(v.p(e,n),oe(v,1)):((v=Le(n)).c(),oe(v,1),v.m(t,null)):v&&(ne(),se(v,1,()=>{v=null}),re())},i(e){f||(oe(v),f=!0)},o(e){se(v),f=!1},d(e){e&&k(t),v&&v.d(),s(m)}}}function He(e,t,n){let r,{title:o,min:s,max:a,step:i,value:l,keyboardKeys:u=null,customValueDisplay:c=null}=t;return e.$set=(e=>{"title"in e&&n("title",o=e.title),"min"in e&&n("min",s=e.min),"max"in e&&n("max",a=e.max),"step"in e&&n("step",i=e.step),"value"in e&&n("value",l=e.value),"keyboardKeys"in e&&n("keyboardKeys",u=e.keyboardKeys),"customValueDisplay"in e&&n("customValueDisplay",c=e.customValueDisplay)}),e.$$.update=((e={customValueDisplay:1,value:1})=>{(e.customValueDisplay||e.value)&&n("formattedValue",r=null!=c&&null!=c[l]?c[l]:l)}),{title:o,min:s,max:a,step:i,value:l,keyboardKeys:u,customValueDisplay:c,formattedValue:r,change_handler:function(t){R(e,t)},input_change_input_handler:function(){l=function(e){return""===e?void 0:+e}(this.value),n("value",l)}}}class Je extends $e{constructor(e){super(),pe(this,e,He,ze,i,["title","min","max","step","value","keyboardKeys","customValueDisplay"])}}function We(e){var t,r,o,s,a,i=[e.volumeControl];function l(t){e.slidecontrol0_value_binding.call(null,t),r=!0,Z(()=>r=!1)}let u={};for(var c=0;c<i.length;c+=1)u=n(u,i[c]);void 0!==e.$volume&&(u.value=e.$volume);var d=new Je({props:u});U.push(()=>de(d,"value",l));var f=[e.octaveControl];function m(t){e.slidecontrol1_value_binding.call(null,t),s=!0,Z(()=>s=!1)}let v={};for(c=0;c<f.length;c+=1)v=n(v,f[c]);void 0!==e.$octaveShift&&(v.value=e.$octaveShift);var p=new Je({props:v});return U.push(()=>de(p,"value",m)),{c(){t=x("div"),d.$$.fragment.c(),o=S(),p.$$.fragment.c(),V(t,"class","flex svelte-5btvnq")},m(e,n){b(e,t,n),fe(d,t,null),y(t,o),fe(p,t,null),a=!0},p(e,t){var n=e.volumeControl?ce(i,[t.volumeControl]):{};!r&&e.$volume&&(n.value=t.$volume),d.$set(n);var o=e.octaveControl?ce(f,[t.octaveControl]):{};!s&&e.$octaveShift&&(o.value=t.$octaveShift),p.$set(o)},i(e){a||(oe(d.$$.fragment,e),oe(p.$$.fragment,e),a=!0)},o(e){se(d.$$.fragment,e),se(p.$$.fragment,e),a=!1},d(e){e&&k(t),me(d),me(p)}}}function Ze(e,t,n){let r,o;l(e,Ee,e=>{n("$volume",r=e)}),l(e,je,e=>{n("$octaveShift",o=e)});return{volumeControl:{title:"Volume",min:0,max:100,step:1,keyboardKeys:[{label:"-1",key:"←"},{label:"+1",key:"→"},{label:"+10",key:"↑"},{label:"-10",key:"↓"}]},octaveControl:{title:"Octave shift",min:-3,max:3,step:.5,keyboardKeys:[{label:"Up",key:"⇧",square:!1},{label:"Dn",key:"<small>Ctrl</small>",square:!1}]},$volume:r,$octaveShift:o,slidecontrol0_value_binding:function(e){r=e,Ee.set(r)},slidecontrol1_value_binding:function(e){o=e,je.set(o)}}}class Qe extends $e{constructor(e){super(),pe(this,e,Ze,We,i,[])}}function Ye(t){var n;return{c(){(n=x("div")).innerHTML='<div class="piano-grid svelte-15or69m"><div id="⇪" class="white-key svelte-15or69m">⇪</div> <div id="A" class="white-key svelte-15or69m">A</div> <div id="S" class="white-key svelte-15or69m">S</div> <div id="D" class="white-key svelte-15or69m">D</div> <div id="F" class="white-key svelte-15or69m">F</div> <div id="G" class="white-key svelte-15or69m">G</div> <div id="H" class="white-key svelte-15or69m">H</div> <div id="J" class="white-key svelte-15or69m">J</div> <div id="K" class="white-key svelte-15or69m">K</div> <div id="L" class="white-key svelte-15or69m">L</div> <div id="Č" class="white-key svelte-15or69m">Č</div> <div id="Ć" class="white-key svelte-15or69m">Ć</div> <div id="Ž" class="white-key svelte-15or69m">Ž</div> <div id="↵" class="white-key svelte-15or69m">↵</div></div> <div class="piano-grid svelte-15or69m"><div id="Q" class="black-key svelte-15or69m">Q</div> <div id="W" class="black-key svelte-15or69m">W</div> <div id="E" class="black-key svelte-15or69m">E</div> <div class="blank-black-key svelte-15or69m"></div> <div id="T" class="black-key svelte-15or69m">T</div> <div id="Z" class="black-key svelte-15or69m">Z</div> <div class="blank-black-key svelte-15or69m"></div> <div id="I" class="black-key svelte-15or69m">I</div> <div id="O" class="black-key svelte-15or69m">O</div> <div id="P" class="black-key svelte-15or69m">P</div> <div class="blank-black-key svelte-15or69m"></div> <div id="Đ" class="black-key svelte-15or69m">Đ</div> <div id="⌫" class="black-key svelte-15or69m">⌫</div></div>',V(n,"class","piano-grid-container svelte-15or69m")},m(e,t){b(e,n,t)},p:e,i:e,o:e,d(e){e&&k(n)}}}class Xe extends $e{constructor(e){super(),pe(this,e,null,Ye,i,[])}}function et(e){const t=e-1;return t*t*t+1}function tt(e,{delay:t=0,duration:n=400,easing:r=et}){const o=getComputedStyle(e),s=+o.opacity,a=parseFloat(o.height),i=parseFloat(o.paddingTop),l=parseFloat(o.paddingBottom),u=parseFloat(o.marginTop),c=parseFloat(o.marginBottom),d=parseFloat(o.borderTopWidth),f=parseFloat(o.borderBottomWidth);return{delay:t,duration:n,easing:r,css:e=>"overflow: hidden;"+`opacity: ${Math.min(20*e,1)*s};`+`height: ${e*a}px;`+`padding-top: ${e*i}px;`+`padding-bottom: ${e*l}px;`+`margin-top: ${e*u}px;`+`margin-bottom: ${e*c}px;`+`border-top-width: ${e*d}px;`+`border-bottom-width: ${e*f}px;`}}function nt(e,t,n){const r=getComputedStyle(e),o="none"===r.transform?"":r.transform,s=t.from.left-t.to.left,i=t.from.top-t.to.top,l=Math.sqrt(s*s+i*i),{delay:u=0,duration:c=(e=>120*Math.sqrt(e)),easing:d=et}=n;return{delay:u,duration:a(c)?c(l):c,easing:d,css:(e,t)=>`transform: ${o} translate(${t*s}px, ${t*i}px);`}}function rt(e){var t,n,r,o;const a=e.$$slots.default,i=u(a,e,null);return{c(){t=x("div"),i&&i.c(),V(t,"animation:flip",{duration:300}),V(t,"class","card svelte-kgtaad"),I(t,"active",e.active),I(t,"disabled",e.disabled&&!e.active),I(t,"selectable",e.selectable),o=[A(t,"click",e.click_handler),A(t,"mouseover",e.mouseover_handler_1),A(t,"mouseleave",e.mouseleave_handler_1)]},l(e){i&&i.l(div_nodes)},m(e,n){b(e,t,n),i&&i.m(t,null),r=!0},p(e,n){i&&i.p&&e.$$scope&&i.p(d(a,n,e,null),c(a,n,null)),e.active&&I(t,"active",n.active),(e.disabled||e.active)&&I(t,"disabled",n.disabled&&!n.active),e.selectable&&I(t,"selectable",n.selectable)},i(e){r||(oe(i,e),W(()=>{n||(n=ae(t,tt,{},!0)),n.run(1)}),r=!0)},o(e){se(i,e),n||(n=ae(t,tt,{},!1)),n.run(0),r=!1},d(e){e&&k(t),i&&i.d(e),e&&n&&n.end(),s(o)}}}function ot(e){var t,n,r,o;const a=e.$$slots.default,i=u(a,e,null);return{c(){t=x("div"),i&&i.c(),V(t,"animation:flip",{duration:300}),V(t,"class","card passive svelte-kgtaad"),I(t,"active",e.active),I(t,"disabled",e.disabled),I(t,"selectable",e.selectable),o=[A(t,"mouseover",e.mouseover_handler),A(t,"mouseleave",e.mouseleave_handler)]},l(e){i&&i.l(div_nodes)},m(e,n){b(e,t,n),i&&i.m(t,null),r=!0},p(e,n){i&&i.p&&e.$$scope&&i.p(d(a,n,e,null),c(a,n,null)),e.active&&I(t,"active",n.active),e.disabled&&I(t,"disabled",n.disabled),e.selectable&&I(t,"selectable",n.selectable)},i(e){r||(oe(i,e),W(()=>{n||(n=ae(t,tt,{},!0)),n.run(1)}),r=!0)},o(e){se(i,e),n||(n=ae(t,tt,{},!1)),n.run(0),r=!1},d(e){e&&k(t),i&&i.d(e),e&&n&&n.end(),s(o)}}}function st(e){var t,n,r,o,s=[ot,rt],a=[];function i(e){return e.passive?0:1}return t=i(e),n=a[t]=s[t](e),{c(){n.c(),r=T()},m(e,n){a[t].m(e,n),b(e,r,n),o=!0},p(e,o){var l=t;(t=i(o))===l?a[t].p(e,o):(ne(),se(a[l],1,()=>{a[l]=null}),re(),(n=a[t])||(n=a[t]=s[t](o)).c(),oe(n,1),n.m(r.parentNode,r))},i(e){o||(oe(n),o=!0)},o(e){se(n),o=!1},d(e){a[t].d(e),e&&k(r)}}}function at(e,t,n){let{disabled:r=!1,active:o=!1,selectable:s=!1,passive:a=!0}=t,{$$slots:i={},$$scope:l}=t;return e.$set=(e=>{"disabled"in e&&n("disabled",r=e.disabled),"active"in e&&n("active",o=e.active),"selectable"in e&&n("selectable",s=e.selectable),"passive"in e&&n("passive",a=e.passive),"$$scope"in e&&n("$$scope",l=e.$$scope)}),{disabled:r,active:o,selectable:s,passive:a,mouseover_handler:function(t){R(e,t)},mouseleave_handler:function(t){R(e,t)},click_handler:function(t){R(e,t)},mouseover_handler_1:function(t){R(e,t)},mouseleave_handler_1:function(t){R(e,t)},$$slots:i,$$scope:l}}class it extends $e{constructor(e){super(),pe(this,e,at,st,i,["disabled","active","selectable","passive"])}}function lt(e){var t,n,r,o;return{c(){t=x("span"),n=_(e.volTxt),V(t,"class","svelte-1wicert")},m(e,r){b(e,t,r),y(t,n),o=!0},p(e,t){o&&!e.volTxt||D(n,t.volTxt)},i(e){o||(W(()=>{r||(r=ae(t,tt,{},!0)),r.run(1)}),o=!0)},o(e){r||(r=ae(t,tt,{},!1)),r.run(0),o=!1},d(e){e&&(k(t),r&&r.end())}}}function ut(e){var t,n,r,o,s,a,i,l,u,c,d,f,m=new ye({props:{outline:!0,$$slots:{default:[ct]},$$scope:{ctx:e}}});m.$on("click",e.octavePlus);var v=new ye({props:{outline:!0,spaced:!0,$$slots:{default:[dt]},$$scope:{ctx:e}}});v.$on("click",e.octaveMinus);var p=new ye({props:{outline:!0,$$slots:{default:[ft]},$$scope:{ctx:e}}});function $(t){e.slidecontrol_value_binding.call(null,t),u=!0,Z(()=>u=!1)}p.$on("click",e.removeInstrument);let h={min:-1,max:100,step:1,title:"Volume",customValueDisplay:{"-1":"Default",0:"Muted"}};void 0!==e.volume&&(h.value=e.volume);var g=new Je({props:h});U.push(()=>de(g,"value",$)),g.$on("change",e.setVolume);var w=e.$showAdsr&&mt(e);return{c(){t=x("div"),m.$$.fragment.c(),n=S(),v.$$.fragment.c(),r=S(),p.$$.fragment.c(),o=S(),s=x("br"),a=S(),i=x("br"),l=S(),g.$$.fragment.c(),c=S(),w&&w.c(),V(t,"class","toolbar svelte-1wicert")},m(e,u){b(e,t,u),fe(m,t,null),y(t,n),fe(v,t,null),y(t,r),fe(p,t,null),y(t,o),y(t,s),y(t,a),y(t,i),y(t,l),fe(g,t,null),y(t,c),w&&w.m(t,null),f=!0},p(e,n){var r={};e.$$scope&&(r.$$scope={changed:e,ctx:n}),m.$set(r);var o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),v.$set(o);var s={};e.$$scope&&(s.$$scope={changed:e,ctx:n}),p.$set(s);var a={};!u&&e.volume&&(a.value=n.volume),g.$set(a),n.$showAdsr?w?(w.p(e,n),oe(w,1)):((w=mt(n)).c(),oe(w,1),w.m(t,null)):w&&(ne(),se(w,1,()=>{w=null}),re())},i(e){f||(oe(m.$$.fragment,e),oe(v.$$.fragment,e),oe(p.$$.fragment,e),oe(g.$$.fragment,e),oe(w),W(()=>{d||(d=ae(t,tt,{},!0)),d.run(1)}),f=!0)},o(e){se(m.$$.fragment,e),se(v.$$.fragment,e),se(p.$$.fragment,e),se(g.$$.fragment,e),se(w),d||(d=ae(t,tt,{},!1)),d.run(0),f=!1},d(e){e&&k(t),me(m),me(v),me(p),me(g),w&&w.d(),e&&d&&d.end()}}}function ct(e){var t;return{c(){t=_("Octave +")},m(e,n){b(e,t,n)},d(e){e&&k(t)}}}function dt(e){var t;return{c(){t=_("Octave -")},m(e,n){b(e,t,n)},d(e){e&&k(t)}}}function ft(e){var t;return{c(){t=_("Remove")},m(e,n){b(e,t,n)},d(e){e&&k(t)}}}function mt(e){var t,n,r,o,s,a,i,l;function u(n){e.slidecontrol0_value_binding.call(null,n),t=!0,Z(()=>t=!1)}let c={min:-.01,max:1,step:.01,title:"Attack",customValueDisplay:{"-0.01":"Default",.005:"Default"}};void 0!==e.adsr[0]&&(c.value=e.adsr[0]);var d=new Je({props:c});function f(t){e.slidecontrol1_value_binding.call(null,t),r=!0,Z(()=>r=!1)}U.push(()=>de(d,"value",u)),d.$on("change",e.setAdsr);let m={min:-.01,max:1,step:.01,title:"Delay",customValueDisplay:{"-0.01":"Default",.395:"Default"}};void 0!==e.adsr[1]&&(m.value=e.adsr[1]);var v=new Je({props:m});function p(t){e.slidecontrol2_value_binding.call(null,t),s=!0,Z(()=>s=!1)}U.push(()=>de(v,"value",f)),v.$on("change",e.setAdsr);let $={min:-.01,max:1,step:.01,title:"Sustain",customValueDisplay:{"-0.01":"Default",.8:"Default"}};void 0!==e.adsr[2]&&($.value=e.adsr[2]);var h=new Je({props:$});function g(t){e.slidecontrol3_value_binding.call(null,t),i=!0,Z(()=>i=!1)}U.push(()=>de(h,"value",p)),h.$on("change",e.setAdsr);let y={min:-.01,max:1,step:.01,title:"Release",customValueDisplay:{"-0.01":"Default",1.2:"Default"}};void 0!==e.adsr[3]&&(y.value=e.adsr[3]);var w=new Je({props:y});return U.push(()=>de(w,"value",g)),w.$on("change",e.setAdsr),{c(){d.$$.fragment.c(),n=S(),v.$$.fragment.c(),o=S(),h.$$.fragment.c(),a=S(),w.$$.fragment.c()},m(e,t){fe(d,e,t),b(e,n,t),fe(v,e,t),b(e,o,t),fe(h,e,t),b(e,a,t),fe(w,e,t),l=!0},p(e,n){var o={};!t&&e.adsr&&(o.value=n.adsr[0]),d.$set(o);var a={};!r&&e.adsr&&(a.value=n.adsr[1]),v.$set(a);var l={};!s&&e.adsr&&(l.value=n.adsr[2]),h.$set(l);var u={};!i&&e.adsr&&(u.value=n.adsr[3]),w.$set(u)},i(e){l||(oe(d.$$.fragment,e),oe(v.$$.fragment,e),oe(h.$$.fragment,e),oe(w.$$.fragment,e),l=!0)},o(e){se(d.$$.fragment,e),se(v.$$.fragment,e),se(h.$$.fragment,e),se(w.$$.fragment,e),l=!1},d(e){me(d,e),e&&k(n),me(v,e),e&&k(o),me(h,e),e&&k(a),me(w,e)}}}function vt(e){var t,n,r,o,s,a,i,l,u,c,d,f,m,v,p,$=$t(e.name),h=$t(e.soundfont),g=e.volume>-1&&lt(e),w=e.optionsVisible&&ut(e);return{c(){t=x("h4"),n=_($),r=S(),o=x("div"),s=x("span"),a=_(e.octShift),i=S(),l=x("span"),u=_("Sound font: "),c=_(h),f=S(),g&&g.c(),m=S(),w&&w.c(),v=T(),V(t,"class","svelte-1wicert"),V(s,"class","svelte-1wicert"),V(l,"class","svelte-1wicert"),V(o,"class","status svelte-1wicert")},m(e,d){b(e,t,d),y(t,n),b(e,r,d),b(e,o,d),y(o,s),y(s,a),y(o,i),y(o,l),y(l,u),y(l,c),y(o,f),g&&g.m(o,null),b(e,m,d),w&&w.m(e,d),b(e,v,d),p=!0},p(e,t){p&&!e.name||$===($=$t(t.name))||D(n,$),p&&!e.octShift||D(a,t.octShift),p&&!e.soundfont||h===(h=$t(t.soundfont))||D(c,h),t.volume>-1?g?(g.p(e,t),oe(g,1)):((g=lt(t)).c(),oe(g,1),g.m(o,null)):g&&(ne(),se(g,1,()=>{g=null}),re()),t.optionsVisible?w?(w.p(e,t),oe(w,1)):((w=ut(t)).c(),oe(w,1),w.m(v.parentNode,v)):w&&(ne(),se(w,1,()=>{w=null}),re())},i(e){p||(W(()=>{d||(d=ae(l,tt,{},!0)),d.run(1)}),oe(g),oe(w),p=!0)},o(e){d||(d=ae(l,tt,{},!1)),d.run(0),se(g),se(w),p=!1},d(e){e&&(k(t),k(r),k(o),d&&d.end()),g&&g.d(),e&&k(m),w&&w.d(e),e&&k(v)}}}function pt(e){var t,n=new it({props:{$$slots:{default:[vt]},$$scope:{ctx:e}}});return n.$on("mouseover",e.mouseover_handler),n.$on("mouseleave",e.mouseleave_handler),{c(){n.$$.fragment.c()},m(e,r){fe(n,e,r),t=!0},p(e,t){var r={};(e.$$scope||e.optionsVisible||e.$showAdsr||e.adsr||e.volume||e.volTxt||e.soundfont||e.octShift||e.name)&&(r.$$scope={changed:e,ctx:t}),n.$set(r)},i(e){t||(oe(n.$$.fragment,e),t=!0)},o(e){se(n.$$.fragment,e),t=!1},d(e){me(n,e)}}}function $t(e){return(e=e.replace(/_/g," ")).charAt(0).toUpperCase()+e.slice(1)}function ht(e,t,n){return e<=t?t:e>=n?n:e}function gt(e,t,n){let r,o,s,a;l(e,Ne,e=>{n("$instrumentSets",r=e)}),l(e,qe,e=>{n("$activeSet",o=e)}),l(e,je,e=>{n("$octaveShift",s=e)}),l(e,Fe,e=>{n("$showAdsr",a=e)});let i,u,{id:c,name:d,volume:f,octave:m,data:v,soundfont:p,adsr:$}=t,h=!1;return e.$set=(e=>{"id"in e&&n("id",c=e.id),"name"in e&&n("name",d=e.name),"volume"in e&&n("volume",f=e.volume),"octave"in e&&n("octave",m=e.octave),"data"in e&&n("data",v=e.data),"soundfont"in e&&n("soundfont",p=e.soundfont),"adsr"in e&&n("adsr",$=e.adsr)}),e.$$.update=((e={octave:1,volume:1})=>{e.octave&&n("octShift",i=0==m?"No octave shift":m<0?`Octave ${m}`:`Octave +${m}`),e.volume&&n("volTxt",u=f>-1?f<1?"Muted":`Volume ${f}`:"Custom volume not set")}),{id:c,name:d,volume:f,octave:m,data:v,soundfont:p,adsr:$,optionsVisible:h,octavePlus:function(){let e=r,t=e[o].instruments.findIndex(e=>e.id===c),n=e[o].instruments[t].octave;e[o].instruments[t].octave=ht(n+s+1,-3,3),Ne.set(e)},octaveMinus:function(){let e=r,t=e[o].instruments.findIndex(e=>e.id===c),n=e[o].instruments[t].octave;e[o].instruments[t].octave=ht(n+s-1,-3,3),Ne.set(e)},removeInstrument:function(){let e=r;e[o].instruments=e[o].instruments.filter(e=>e.id!==c),Ne.set(e)},setVolume:function(){let e=r,t=e[o].instruments.findIndex(e=>e.id===c);e[o].instruments[t].volume=f,Ne.set(e)},setAdsr:function(){let e=r,t=e[o].instruments.findIndex(e=>e.id===c);e[o].instruments[t].adsr=$,Ne.set(e)},octShift:i,volTxt:u,$showAdsr:a,slidecontrol_value_binding:function(e){n("volume",f=e)},slidecontrol0_value_binding:function(e){$[0]=e,n("adsr",$)},slidecontrol1_value_binding:function(e){$[1]=e,n("adsr",$)},slidecontrol2_value_binding:function(e){$[2]=e,n("adsr",$)},slidecontrol3_value_binding:function(e){$[3]=e,n("adsr",$)},mouseover_handler:function(){const e=h=!0;return n("optionsVisible",h),e},mouseleave_handler:function(){const e=h=!1;return n("optionsVisible",h),e}}}class yt extends $e{constructor(e){super(),pe(this,e,gt,pt,i,["id","name","volume","octave","data","soundfont","adsr"])}}function bt(e,t,n){const r=Object.create(e);return r.instrument=t[n],r.i=n,r}function kt(e,t,n){const r=Object.create(e);return r.name=t[n],r}function wt(e){var t,n,r,o=Vt(e.name);return{c(){t=x("option"),n=_(o),t.__value=r=e.name,t.value=t.__value},m(e,r){b(e,t,r),y(t,n)},p(e,s){e.availInstruments&&o!==(o=Vt(s.name))&&D(n,o),e.availInstruments&&r!==(r=s.name)&&(t.__value=r),t.value=t.__value},d(e){e&&k(t)}}}function xt(e){var t;return{c(){t=_("Add instrument")},m(e,n){b(e,t,n)},d(e){e&&k(t)}}}function _t(e){var t;return{c(){t=_(e.$currentSoundFont)},m(e,n){b(e,t,n)},p(e,n){e.$currentSoundFont&&D(t,n.$currentSoundFont)},d(e){e&&k(t)}}}function St(e){var t,n=e.$showAdsr?"Yes":"No";return{c(){t=_(n)},m(e,n){b(e,t,n)},p(e,r){e.$showAdsr&&n!==(n=r.$showAdsr?"Yes":"No")&&D(t,n)},d(e){e&&k(t)}}}function Tt(e){var t;return{c(){(t=x("p")).textContent="No instruments"},m(e,n){b(e,t,n)},d(e){e&&k(t)}}}function At(e,t){var r,o,s=[t.instrument];let a={};for(var i=0;i<s.length;i+=1)a=n(a,s[i]);var l=new yt({props:a});return{key:e,first:null,c(){r=T(),l.$$.fragment.c(),this.first=r},m(e,t){b(e,r,t),fe(l,e,t),o=!0},p(e,t){var n=e.$instrumentSets||e.$activeSet?ce(s,[t.instrument]):{};l.$set(n)},i(e){o||(oe(l.$$.fragment,e),o=!0)},o(e){se(l.$$.fragment,e),o=!1},d(e){e&&k(r),me(l,e)}}}function Mt(e){for(var t,n,r,o,s,a,i,l,u,c,d,f,m,v,p,$,h,g,T=e.$instrumentSets[e.$activeSet].name,M=[],I=new Map,q=e.availInstruments,E=[],j=0;j<q.length;j+=1)E[j]=wt(kt(e,q,j));var F=new ye({props:{style:"height: 32px; margin-left: -4px; border-top-left-radius:0;\r\n      border-bottom-left-radius: 0;",$$slots:{default:[xt]},$$scope:{ctx:e}}});F.$on("click",e.addInstrument);var N=new ye({props:{$$slots:{default:[_t]},$$scope:{ctx:e}}});N.$on("click",e.switchSf);var P=new ye({props:{$$slots:{default:[St]},$$scope:{ctx:e}}});P.$on("click",e.switchAdsrOpt);var K=e.$instrumentSets[e.$activeSet].instruments;const R=e=>e.instrument.id;for(j=0;j<K.length;j+=1){let t=bt(e,K,j),n=R(t);I.set(n,M[j]=At(n,t))}var B=null;return K.length||(B=Tt()).c(),{c(){t=x("div"),n=x("h4"),r=_(T),o=S(),s=x("div"),a=x("select");for(var h=0;h<E.length;h+=1)E[h].c();for(i=S(),F.$$.fragment.c(),l=S(),u=x("div"),(c=x("span")).textContent="Sound font",d=S(),N.$$.fragment.c(),f=S(),(m=x("span")).textContent="Show ADSR ctrl.",v=S(),P.$$.fragment.c(),p=S(),$=x("div"),h=0;h<M.length;h+=1)M[h].c();V(n,"class","svelte-htwent"),void 0===e.selectedInstrument&&W(()=>e.select_change_handler.call(a)),C(a,"height","32px"),C(a,"border-top-right-radius","0"),C(a,"border-bottom-right-radius","0"),V(a,"class","svelte-htwent"),V(s,"class","selector"),V(c,"class","svelte-htwent"),C(m,"margin-left","0.8rem"),V(m,"class","svelte-htwent"),V(u,"class","sfselect svelte-htwent"),V($,"class","list svelte-htwent"),C(t,"width","22rem"),g=A(a,"change",e.select_change_handler)},m(g,k){b(g,t,k),y(t,n),y(n,r),y(t,o),y(t,s),y(s,a);for(var w=0;w<E.length;w+=1)E[w].m(a,null);for(O(a,e.selectedInstrument),y(s,i),fe(F,s,null),y(t,l),y(t,u),y(u,c),y(u,d),fe(N,u,null),y(u,f),y(u,m),y(u,v),fe(P,u,null),y(t,p),y(t,$),w=0;w<M.length;w+=1)M[w].m($,null);B&&B.m($,null),h=!0},p(e,t){if(h&&!e.$instrumentSets&&!e.$activeSet||T===(T=t.$instrumentSets[t.$activeSet].name)||D(r,T),e.availInstruments||e.normalizeInstrumentName){q=t.availInstruments;for(var n=0;n<q.length;n+=1){const r=kt(t,q,n);E[n]?E[n].p(e,r):(E[n]=wt(r),E[n].c(),E[n].m(a,null))}for(;n<E.length;n+=1)E[n].d(1);E.length=q.length}e.selectedInstrument&&O(a,t.selectedInstrument);var o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),F.$set(o);var s={};(e.$$scope||e.$currentSoundFont)&&(s.$$scope={changed:e,ctx:t}),N.$set(s);var i={};(e.$$scope||e.$showAdsr)&&(i.$$scope={changed:e,ctx:t}),P.$set(i);const l=t.$instrumentSets[t.$activeSet].instruments;ne(),M=ue(M,e,R,1,t,l,I,$,ie,At,null,bt),re(),l.length?B&&(B.d(1),B=null):B||((B=Tt()).c(),B.m($,null))},i(e){if(!h){oe(F.$$.fragment,e),oe(N.$$.fragment,e),oe(P.$$.fragment,e);for(var t=0;t<K.length;t+=1)oe(M[t]);h=!0}},o(e){for(se(F.$$.fragment,e),se(N.$$.fragment,e),se(P.$$.fragment,e),j=0;j<M.length;j+=1)se(M[j]);h=!1},d(e){for(e&&k(t),w(E,e),me(F),me(N),me(P),j=0;j<M.length;j+=1)M[j].d();B&&B.d(),g()}}}function Vt(e){return(e=e.replace(/_/g," ")).charAt(0).toUpperCase()+e.slice(1)}function Dt(e,t,n){let r,o,s,a,i;l(e,Ie,e=>{n("$currentSoundFont",r=e)}),l(e,Ne,e=>{n("$instrumentSets",o=e)}),l(e,qe,e=>{n("$activeSet",s=e)}),l(e,Fe,e=>{n("$showAdsr",a=e)});let u=[];return async function(){let e=await fetch(`http://gleitz.github.io/midi-js-soundfonts/${r}/names.json`);n("availInstruments",u=await e.json()),n("selectedInstrument",i=u[0])}(),{selectedInstrument:i,availInstruments:u,addInstrument:function(){if(null==i)return;let e=Soundfont.instrument(Oe,i,{soundfont:r}),t={id:Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10),name:i,volume:-1,octave:0,data:e,soundfont:r,adsr:[-.01,-.01,-.01,-.01]},n=o;n[s].instruments.push(t),Ne.set(n)},switchSf:function(){let e=r;e==Te.fluid&&Ie.set(Te.mk),e==Te.mk&&Ie.set(Te.fatboy),e==Te.fatboy&&Ie.set(Te.fluid)},switchAdsrOpt:function(){let e=a;Fe.set(!e)},$currentSoundFont:r,$instrumentSets:o,$activeSet:s,$showAdsr:a,select_change_handler:function(){i=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n("selectedInstrument",i),n("availInstruments",u)}}}class Ct extends $e{constructor(e){super(),pe(this,e,Dt,Mt,i,[])}}function Ot(e,t,n){const r=Object.create(e);return r.i=t[n],r}function It(e,t,n){const r=Object.create(e);return r.set=t[n],r.i=n,r}function qt(e){var t;return{c(){(t=x("p")).innerHTML="\n\t\t\t        No instrument sets.\n\t\t\t        <br>\n\t\t\t        This is an error.\n\t\t\t      "},m(e,n){b(e,t,n)},d(e){e&&k(t)}}}function Et(n,r){var o,s,a,i,l,u,c=Pt(r.i.name),d=e;return{key:n,first:null,c(){o=x("span"),s=_(c),a=S(),V(o,"class","instrument svelte-nn8845"),this.first=o},m(e,t){b(e,o,t),y(o,s),y(o,a),u=!0},p(e,t){u&&!e.$instrumentSets||c===(c=Pt(t.i.name))||D(s,c)},r(){l=o.getBoundingClientRect()},f(){!function(e){const t=getComputedStyle(e);if("absolute"!==t.position&&"fixed"!==t.position){const{width:n,height:r}=t,o=e.getBoundingClientRect();e.style.position="absolute",e.style.width=n,e.style.height=r,P(e,o)}}(o),d(),P(o,l)},a(){d(),d=function(n,r,o,s){if(!r)return e;const a=n.getBoundingClientRect();if(r.left===a.left&&r.right===a.right&&r.top===a.top&&r.bottom===a.bottom)return e;const{delay:i=0,duration:l=300,easing:u=t,start:c=f()+i,end:d=c+l,tick:m=e,css:v}=o(n,{from:r,to:a},s);let p,$=!0,h=!1;function y(){v&&N(n,p),$=!1}return g(e=>{if(!h&&e>=c&&(h=!0),h&&e>=d&&(m(1,0),y()),!$)return!1;if(h){const t=0+1*u((e-c)/l);m(t,1-t)}return!0}),v&&(p=F(n,0,1,l,i,u,v)),i||(h=!0),m(0,1),y}(o,l,nt,{})},i(e){u||(W(()=>{i||(i=ae(o,tt,{},!0)),i.run(1)}),u=!0)},o(e){i||(i=ae(o,tt,{},!1)),i.run(0),u=!1},d(e){e&&(k(o),i&&i.end())}}}function jt(e){var t,n,r,o,s,a,i,l,u,c=e.set.name,d=[],f=new Map,m=e.set.instruments;const v=e=>e.i.id;for(var p=0;p<m.length;p+=1){let t=Ot(e,m,p),n=v(t);f.set(n,d[p]=Et(n,t))}var $=new Be({props:{square:!0,key:e.i+1<10?e.i+1:0}});return{c(){for(t=x("div"),n=x("div"),r=x("h5"),o=_(c),s=S(),p=0;p<d.length;p+=1)d[p].c();a=S(),i=x("div"),$.$$.fragment.c(),l=S(),V(r,"class","svelte-nn8845"),I(r,"act",e.$activeSet===e.i),V(n,"class","f-grow svelte-nn8845"),V(i,"class","f-shrink svelte-nn8845"),V(t,"class","fixed-card svelte-nn8845")},m(e,c){for(b(e,t,c),y(t,n),y(n,r),y(r,o),y(n,s),p=0;p<d.length;p+=1)d[p].m(n,null);y(t,a),y(t,i),fe($,i,null),b(e,l,c),u=!0},p(e,t){u&&!e.$instrumentSets||c===(c=t.set.name)||D(o,c),e.$activeSet&&I(r,"act",t.$activeSet===t.i);const s=t.set.instruments;ne();for(let e=0;e<d.length;e+=1)d[e].r();d=ue(d,e,v,1,t,s,f,n,le,Et,null,Ot);for(let e=0;e<d.length;e+=1)d[e].a();re()},i(e){if(!u){for(var t=0;t<m.length;t+=1)oe(d[t]);oe($.$$.fragment,e),u=!0}},o(e){for(p=0;p<d.length;p+=1)se(d[p]);se($.$$.fragment,e),u=!1},d(e){for(e&&k(t),p=0;p<d.length;p+=1)d[p].d();me($),e&&k(l)}}}function Ft(e){var t;var n=new it({props:{disabled:e.set.instruments.length<1,passive:!1,active:e.$activeSet===e.i,$$slots:{default:[jt]},$$scope:{ctx:e}}});return n.$on("click",function(){return e.click_handler(e)}),{c(){n.$$.fragment.c()},m(e,r){fe(n,e,r),t=!0},p(t,r){e=r;var o={};t.$instrumentSets&&(o.disabled=e.set.instruments.length<1),t.$activeSet&&(o.active=e.$activeSet===e.i),(t.$$scope||t.$instrumentSets||t.$activeSet)&&(o.$$scope={changed:t,ctx:e}),n.$set(o)},i(e){t||(oe(n.$$.fragment,e),t=!0)},o(e){se(n.$$.fragment,e),t=!1},d(e){me(n,e)}}}function Nt(e){for(var t,n,r,o,s,a=e.$instrumentSets,i=[],l=0;l<a.length;l+=1)i[l]=Ft(It(e,a,l));const u=e=>se(i[e],1,()=>{i[e]=null});var c=null;return a.length||(c=qt()).c(),{c(){t=x("div"),(n=x("h4")).textContent="Instrument sets",r=S(),o=x("div");for(var e=0;e<i.length;e+=1)i[e].c();C(n,"font-weight","600"),V(n,"class","svelte-nn8845"),V(o,"class","list svelte-nn8845"),V(t,"class","container svelte-nn8845")},m(e,a){b(e,t,a),y(t,n),y(t,r),y(t,o);for(var l=0;l<i.length;l+=1)i[l].m(o,null);c&&c.m(o,null),s=!0},p(e,t){if(e.$instrumentSets||e.$activeSet||e.normalizedName){a=t.$instrumentSets;for(var n=0;n<a.length;n+=1){const r=It(t,a,n);i[n]?(i[n].p(e,r),oe(i[n],1)):(i[n]=Ft(r),i[n].c(),oe(i[n],1),i[n].m(o,null))}for(ne(),n=a.length;n<i.length;n+=1)u(n);re()}a.length?c&&(c.d(1),c=null):c||((c=qt()).c(),c.m(o,null))},i(e){if(!s){for(var t=0;t<a.length;t+=1)oe(i[t]);s=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)se(i[e]);s=!1},d(e){e&&k(t),w(i,e),c&&c.d()}}}function Pt(e){return(e=e.replace(/_/g," ")).charAt(0).toUpperCase()+e.slice(1)}function Kt(e,t,n){let r,o;return l(e,Ne,e=>{n("$instrumentSets",r=e)}),l(e,qe,e=>{n("$activeSet",o=e)}),{$instrumentSets:r,$activeSet:o,click_handler:function({i:e}){qe.set(e)}}}class Rt extends $e{constructor(e){super(),pe(this,e,Kt,Nt,i,[])}}function Bt(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function Ut(e,t){return e(t={exports:{}},t.exports),t.exports}var Lt={decode:function(e,t){for(var n,r,o,s=e.replace(/[^A-Za-z0-9\+\/]/g,""),a=s.length,i=t?Math.ceil((3*a+1>>2)/t)*t:3*a+1>>2,l=new Uint8Array(i),u=0,c=0,d=0;d<a;d++)if(r=3&d,u|=((o=s.charCodeAt(d))>64&&o<91?o-65:o>96&&o<123?o-71:o>47&&o<58?o+4:43===o?62:47===o?63:0)<<18-6*r,3===r||a-d==1){for(n=0;n<3&&c<i;n++,c++)l[c]=u>>>(16>>>n&24)&255;u=0}return l}},Gt=function(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;t&&(o.responseType=t),o.open("GET",e),o.onload=function(){200===o.status?n(o.response):r(Error(o.statusText))},o.onerror=function(){r(Error("Network Error"))},o.send()})},zt=Ut(function(e){function t(e){return function(t){return"string"==typeof t&&e.test(t)}}function n(e,t){return"string"==typeof e?e+t:"function"==typeof e?e(t):t}function r(e,t,n,r){var h=t instanceof ArrayBuffer?o:s(t)?a:function(e){return e&&"function"==typeof e.then}(t)?i:l(t)?u:function(e){return e&&"object"==typeof e}(t)?c:d(t)?f:m(t)?v:p(t)?$:null;return h?h(e,t,n||{}):r?Promise.resolve(r):Promise.reject("Source not valid ("+t+")")}function o(e,t,n){return new Promise(function(n,r){e.decodeAudioData(t,function(e){n(e)},function(){r("Can't decode audio data ("+t.slice(0,30)+"...)")})})}r.fetch=Gt;var s=t(/\.(mp3|wav|ogg)(\?.*)?$/i);function a(e,t,o){var s=n(o.from,t);return r(e,r.fetch(s,"arraybuffer"),o)}function i(e,t,n){return t.then(function(t){return r(e,t,n)})}var l=Array.isArray;function u(e,t,n){return Promise.all(t.map(function(t){return r(e,t,n,t)}))}function c(e,t,n){var o={},s=Object.keys(t).map(function(s){if(n.only&&-1===n.only.indexOf(s))return null;var a=t[s];return r(e,a,n,a).then(function(e){o[s]=e})});return Promise.all(s).then(function(){return o})}var d=t(/\.json(\?.*)?$/i);function f(e,t,o){var s=n(o.from,t);return r(e,r.fetch(s,"text").then(JSON.parse),o)}var m=t(/^data:audio/);function v(e,t,n){var o=t.indexOf(",");return r(e,Lt.decode(t.slice(o+1)).buffer,n)}var p=t(/\.js(\?.*)?$/i);function $(e,t,o){var s=n(o.from,t);return r(e,r.fetch(s,"text").then(h),o)}function h(e){var t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");t=e.indexOf("=",t)+2;var n=e.lastIndexOf(",");return JSON.parse(e.slice(t,n)+"}")}e.exports&&(e.exports=r),"undefined"!=typeof window&&(window.loadAudio=r)}),Ht=function(e){var t=e.createGain(),n=t._voltage=function(e){var t=e.createBufferSource(),n=e.createBuffer(1,2,e.sampleRate);return n.getChannelData(0).set(Wt),t.buffer=n,t.loop=!0,t}(e),r=Zt(n),o=Zt(n),s=Zt(n);return t._startAmount=Zt(o),t._endAmount=Zt(s),t._multiplier=Zt(r),t._multiplier.connect(t),t._startAmount.connect(t),t._endAmount.connect(t),t.value=r.gain,t.startValue=o.gain,t.endValue=s.gain,t.startValue.value=0,t.endValue.value=0,Object.defineProperties(t,Jt),t};var Jt={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,r=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var o=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),r.cancelScheduledValues(e),r.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(o,this._decayFrom,Qt(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var r=this._multiplier.gain,o=this._startAmount.gain,s=this._endAmount.gain;r.cancelScheduledValues(e),o.cancelScheduledValues(e),s.cancelScheduledValues(e);var a=Qt(this.release);if(this.attack&&e<this._decayFrom){var i=function(e,t,n,r,o){var s=e+(o-n)/(r-n)*(t-e);s<=e&&(s=e);s>=t&&(s=t);return s}(0,1,this._startedAt,this._decayFrom,e);r.linearRampToValueAtTime(i,e),o.linearRampToValueAtTime(1-i,e),o.setTargetAtTime(0,e,a)}s.setTargetAtTime(1,e,a),r.setTargetAtTime(0,e,a)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},Wt=new Float32Array([1,1]);function Zt(e){var t=e.context.createGain();return e.connect(t),t}function Qt(e){return Math.log(e+1)/Math.log(100)}var Yt={},Xt={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function en(e){return"number"==typeof e}var tn=["attack","decay","sustain","release"];var nn=function(e,t,n){var r=!1,o=0,s={},a=e.createGain();a.gain.value=1;var i=Object.assign({},Xt,n),l={context:e,out:a,opts:i};return t instanceof AudioBuffer?l.buffer=t:l.buffers=t,l.start=function(t,n,a){if(l.buffer&&null!==t)return l.start(null,t,n);var i=t?l.buffers[t]:l.buffer;if(i){if(r){var c=a||Yt;n=Math.max(e.currentTime,n||0),l.emit("start",n,t,c);var d=u(t,i,c);return d.id=function(t,n){return n.id=o++,s[n.id]=n,n.source.onended=function(){var t=e.currentTime;n.source.disconnect(),n.env.disconnect(),n.disconnect(),l.emit("ended",t,n.id,n)},n.id}(0,d),d.env.start(n),d.source.start(n),l.emit("started",n,d.id,d),c.duration&&d.stop(n+c.duration),d}console.warn("SamplePlayer not connected to any node.")}else console.warn("Buffer "+t+" not found.")},l.play=function(e,t,n){return l.start(e,t,n)},l.stop=function(e,t){var n;return(t=t||Object.keys(s)).map(function(t){return(n=s[t])?(n.stop(e),n.id):null})},l.connect=function(e){return r=!0,a.connect(e),l},l.emit=function(e,t,n,r){l.onevent&&l.onevent(e,t,n,r);var o=l["on"+e];o&&o(t,n,r)},l;function u(t,n,r){var o,s=e.createGain();return s.gain.value=0,s.connect(a),s.env=function(e,t,n){var r=Ht(e),o=t.adsr||n.adsr;return tn.forEach(function(e,s){r[e]=o?o[s]:t[e]||n[e]}),r.value.value=en(t.gain)?t.gain:en(n.gain)?n.gain:1,r}(e,r,i),s.env.connect(s.gain),s.source=e.createBufferSource(),s.source.buffer=n,s.source.connect(s),s.source.loop=r.loop||i.loop,s.source.playbackRate.value=(o=r.cents||i.cents)?Math.pow(2,o/1200):1,s.source.loopStart=r.loopStart||i.loopStart,s.source.loopEnd=r.loopEnd||i.loopEnd,s.stop=function(n){var r=n||e.currentTime;l.emit("stop",r,t);var o=s.env.stop(r);s.source.stop(o)},s}},rn=function(e){return e.on=function(t,n){if(1===arguments.length&&"function"==typeof t)return e.on("event",t);var r,o,s="on"+t,a=e[s];return e[s]=a?(r=a,o=n,function(e,t,n,s){r(e,t,n,s),o(e,t,n,s)}):n,e},e};var on=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;var sn=[0,2,4,5,7,9,11];function an(e,t,n){if("string"!=typeof e)return null;var r=on.exec(e);if(!r||!t&&r[4])return null;var o={letter:r[1].toUpperCase(),acc:r[2].replace(/x/g,"##")};return o.pc=o.letter+o.acc,o.step=(o.letter.charCodeAt(0)+3)%7,o.alt="b"===o.acc[0]?-o.acc.length:o.acc.length,o.chroma=sn[o.step]+o.alt,r[3]&&(o.oct=+r[3],o.midi=o.chroma+12*(o.oct+1),o.freq=ln(o.midi,n)),t&&(o.tonicOf=r[4]),o}function ln(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var un={parse:an,regex:function(){return on},midiToFreq:ln};["letter","acc","pc","step","alt","chroma","oct","midi","freq"].forEach(function(e){un[e]=function(t){var n=an(t);return n&&void 0!==n[e]?n[e]:null}});var cn=un,dn=function(e){return function(e){return null!==e&&e!==[]&&e>=0&&e<129}(e)?+e:cn.midi(e)},fn=function(e){if(e.buffers){var t=e.opts.map,n="function"==typeof t?t:dn,r=function(e){return e?n(e)||e:null};e.buffers=function(e,t){return Object.keys(e).reduce(function(n,r){return n[t(r)]=e[r],n},{})}(e.buffers,r);var o=e.start;e.start=function(e,t,n){var s=r(e),a=s%1;return a&&(s=Math.floor(s),n=Object.assign(n||{},{cents:Math.floor(100*a)})),o(s,t,n)}}return e};var mn,vn=Array.isArray,pn={},$n=function(e){return e.schedule=function(t,n){var r,o,s,a,i=e.context.currentTime,l=t<i?i:t;return e.emit("schedule",l,n),n.map(function(t){return t?(vn(t)?(r=t[0],o=t[1]):(r=t.time,o=t),!function(e){return e&&"object"==typeof e}(o)?(s=o,a=pn):(s=o.name||o.key||o.note||o.midi||null,a=o),e.start(s,l+(r||0),a)):null})},e},hn=Ut(function(e,t){e.exports=function e(t,n,r){function o(a,i){if(!n[a]){if(!t[a]){var l=Bt;if(!i&&l)return l(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var s=Bt,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return new function(e){if(this._event=e,this._data=e.data,this.receivedTime=e.receivedTime,this._data&&this._data.length<2)console.warn("Illegal MIDI message of length",this._data.length);else switch(this._messageCode=240&e.data[0],this.channel=15&e.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 144:this.messageType="noteon",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 160:this.messageType="keypressure",this.key=127&e.data[1],this.pressure=127&e.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&e.data[1],this.controllerValue=127&e.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=e.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&e.data[1];break;case 224:this.messageType="pitchbendchange";var t=127&e.data[2],n=127&e.data[1];this.pitchBend=(t<<8)+n}}(e)},t.exports=n.default},{}]},{},[1])(1)});(mn=hn)&&mn.__esModule&&Object.prototype.hasOwnProperty.call(mn,"default")&&mn.default;var gn=function(e){return e.listenToMidi=function(t,n){var r={},o=n||{},s=o.gain||function(e){return e/127};return t.onmidimessage=function(t){var n=t.messageType?t:hn(t);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!o.channel||n.channel===o.channel)switch(n.messageType){case"noteon":r[n.key]=e.play(n.key,0,{gain:s(n.velocity)});break;case"noteoff":r[n.key]&&(r[n.key].stop(),delete r[n.key])}},e},e},yn=Ut(function(e){function t(e,t,n){return gn($n(fn(rn(nn(e,t,n)))))}e.exports&&(e.exports=t),"undefined"!=typeof window&&(window.SamplePlayer=t)});function bn(e,t){return Array(t+1).join(e)}function kn(e){return"number"==typeof e}function wn(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var xn=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;var _n=[0,2,4,5,7,9,11];function Sn(e,t,n){if("string"!=typeof e)return null;var r=xn.exec(e);if(!r||!t&&r[4])return null;var o={letter:r[1].toUpperCase(),acc:r[2].replace(/x/g,"##")};o.pc=o.letter+o.acc,o.step=(o.letter.charCodeAt(0)+3)%7,o.alt="b"===o.acc[0]?-o.acc.length:o.acc.length;var s=_n[o.step]+o.alt;return o.chroma=s<0?12+s:s%12,r[3]&&(o.oct=+r[3],o.midi=s+12*(o.oct+1),o.freq=wn(o.midi,n)),t&&(o.tonicOf=r[4]),o}var Tn="CDEFGAB";function An(e){if((kn(e)||"string"==typeof e)&&e>=0&&e<128)return+e;var t=Sn(e);return t&&function(e){return void 0!==e}(t.midi)?t.midi:null}var Mn=Object.freeze({regex:function(){return xn},parse:Sn,build:function e(t,n,r){return null==t?null:t.step?e(t.step,t.alt,t.oct):t<0||t>6?null:Tn.charAt(t)+(kn(o=n)?o<0?bn("b",-o):bn("#",o):"")+function(e){return kn(e)?""+e:""}(r);var o},midi:An,freq:function(e,t){var n=An(e);return null===n?null:wn(n,t)},letter:function(e){return(Sn(e)||{}).letter},acc:function(e){return(Sn(e)||{}).acc},pc:function(e){return(Sn(e)||{}).pc},step:function(e){return(Sn(e)||{}).step},alt:function(e){return(Sn(e)||{}).alt},chroma:function(e){return(Sn(e)||{}).chroma},oct:function(e){return(Sn(e)||{}).oct}});function Vn(e,t){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof Vn))return new Vn(e);this.nameToUrl=t||Vn.nameToUrl,this.ctx=e,this.instruments={},this.promises=[]}function Dn(e,t){return t=t||{},function(n,r,o,s){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var a=n>0&&n<129?+n:Mn.midi(n),i=a?Mn.midiToFreq(a,440):null;if(i){o=o||.2;var l=(s=s||{}).destination||t.destination||e.destination,u=s.vcoType||t.vcoType||"sine",c=s.gain||t.gain||.4,d=e.createOscillator();d.type=u,d.frequency.value=i;var f=e.createGain();return f.gain.value=c,d.connect(f),f.connect(l),d.start(r),o>0&&d.stop(r+o),d}}}Vn.prototype.onready=function(e){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(e)},Vn.prototype.instrument=function(e,t){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((e=e||"default")in this.instruments)return this.instruments[e];var r={name:e,play:Dn(n,t)};if(this.instruments[e]=r,"default"!==e){var o=Vn.instrument(n,e,t).then(function(e){return r.play=e.play,r});this.promises.push(o),r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),o.then(e)}}else r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),e()};return r},Vn.loadBuffers=function(e,t,n){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),Vn.instrument(e,t,n).then(function(e){return e.buffers})},Vn.noteToMidi=Mn.midi;var Cn=Vn;Ut(function(e){function t(e){return/\.js(\?.*)?$/i.test(e)}function n(e,t,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(t="FluidR3_GM"===t?t:"MusyngKite")+"/"+e+"-"+(n="ogg"===n?n:"mp3")+".js"}Cn.instrument=function e(r,o,s){if(1===arguments.length)return function(t,n){return e(r,t,n)};var a=s||{},i=a.isSoundfontURL||t,l=a.nameToUrl||n,u=i(o)?o:l(o,a.soundfont,a.format);return zt(r,u,{only:a.only||a.notes}).then(function(e){var t=yn(r,e,a).connect(a.destination?a.destination:r.destination);return t.url=u,t.name=o,t})},Cn.nameToUrl=n,e.exports&&(e.exports=Cn),"undefined"!=typeof window&&(window.Soundfont=Cn)});function On(e){var t;return{c(){(t=x("h3")).textContent="🎹 Piano",V(t,"slot","left")},m(e,n){b(e,t,n)},d(e){e&&k(t)}}}function In(e){var t;return{c(){t=_("Stop all sounds")},m(e,n){b(e,t,n)},d(e){e&&k(t)}}}function qn(e){var t,n,r=e.darkTheme?"Light":"Dark";return{c(){t=_(r),n=_(" theme")},m(e,r){b(e,t,r),b(e,n,r)},p(e,n){e.darkTheme&&r!==(r=n.darkTheme?"Light":"Dark")&&D(t,r)},d(e){e&&(k(t),k(n))}}}function En(e){var t,n,r,o=new ye({props:{outline:!0,$$slots:{default:[In]},$$scope:{ctx:e}}});o.$on("click",e.stopAllSounds);var s=new ye({props:{spaced:!0,$$slots:{default:[qn]},$$scope:{ctx:e}}});return s.$on("click",e.switchDark),{c(){t=S(),o.$$.fragment.c(),n=S(),s.$$.fragment.c()},m(e,a){b(e,t,a),fe(o,e,a),b(e,n,a),fe(s,e,a),r=!0},p(e,t){var n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),o.$set(n);var r={};(e.$$scope||e.darkTheme)&&(r.$$scope={changed:e,ctx:t}),s.$set(r)},i(e){r||(oe(o.$$.fragment,e),oe(s.$$.fragment,e),r=!0)},o(e){se(o.$$.fragment,e),se(s.$$.fragment,e),r=!1},d(e){e&&k(t),me(o,e),e&&k(n),me(s,e)}}}function jn(e){var t,n,r,o,a,i,l,u,c=new _e({props:{$$slots:{default:[En],left:[On]},$$scope:{ctx:e}}}),d=new Qe({}),f=new Xe({}),m=new Ct({}),v=new Rt({});return{c(){t=x("div"),c.$$.fragment.c(),n=S(),d.$$.fragment.c(),r=S(),f.$$.fragment.c(),o=S(),a=x("div"),m.$$.fragment.c(),i=S(),v.$$.fragment.c(),V(a,"class","split svelte-1o25kvx"),V(t,"class","container"),u=[A(window,"keydown",M(e.handleKeyDown)),A(window,"keyup",M(e.handleKeyUp))]},m(e,s){b(e,t,s),fe(c,t,null),y(t,n),fe(d,t,null),y(t,r),fe(f,t,null),y(t,o),y(t,a),fe(m,a,null),y(a,i),fe(v,a,null),l=!0},p(e,t){var n={};(e.$$scope||e.darkTheme)&&(n.$$scope={changed:e,ctx:t}),c.$set(n)},i(e){l||(oe(c.$$.fragment,e),oe(d.$$.fragment,e),oe(f.$$.fragment,e),oe(m.$$.fragment,e),oe(v.$$.fragment,e),l=!0)},o(e){se(c.$$.fragment,e),se(d.$$.fragment,e),se(f.$$.fragment,e),se(m.$$.fragment,e),se(v.$$.fragment,e),l=!1},d(e){e&&k(t),me(c),me(d),me(f),me(m),me(v),s(u)}}}function Fn(e,t,n){let r,o,s,a,i,u;l(e,Ne,e=>{n("$instrumentSets",r=e)}),l(e,qe,e=>{n("$activeSet",o=e)}),l(e,Ve,e=>{n("$keysPressed",s=e)}),l(e,Ce,e=>{n("$keysDown",a=e)}),l(e,je,e=>{n("$octaveShift",i=e)}),l(e,Ee,e=>{n("$volume",u=e)});let c=!1;function d(){if(!(r[o].instruments.length<1)){for(let e of r[o].instruments)e.data.then(e=>{e.stop()});for(let e in Ae)document.querySelector("#"+Ae[e]).classList.remove("piano-key-highlight")}}return{darkTheme:c,stopAllSounds:d,switchDark:function(){n("darkTheme",c=!c),document.querySelector("html").className=c?"dark":"",console.log(document.querySelector("html").className)},handleKeyDown:function(e){let t=e.keyCode;if(!(r[o].instruments.length<1)&&null!=Ae[t]&&null!=Me[t]&&null!==s[t]&&!0!==a[t]){document.querySelector("#"+Ae[t]).classList.add("piano-key-highlight"),Ce.update(e=>(e[t]=!0,e));for(let e of r[o].instruments){let r=null===e.octave?i:i+e.octave,o=e.volume>-1?e.volume/100:u/100,a=(n=r+e.octave,c=3,n<=(l=-3)?l:n>=c?c:n);e.data.then(n=>{let r=e.adsr;r[0]<0&&(r[0]=De[0]),r[1]<0&&(r[1]=De[1]),r[2]<0&&(r[2]=De[2]),r[3]<0&&(r[3]=De[3]);let i=(parseInt(Me[t])+12*a).toString(),l=n.play(i,Oe.currentTime,{loop:!0,adsr:r,gain:o});if(-1===s[t].indexOf(l)){let e=s[t];Ve.update(n=>(n[t]=[...e,l],n))}})}var n,l,c}},handleKeyUp:function(e){let t=e.keyCode;if(t>=48&&t<=58){d();let e=t-49;48==t&&(e=9),qe.set(e)}if(16!==t)if(17!==t)if(37!==t)if(40!==t)if(39!==t)if(38!==t){if(!(r[o].instruments.length<1)&&null!=Ae[t]&&null!=Me[t]&&null!==s[t]&&!1!==a[t]){for(var n of(document.querySelector("#"+Ae[t]).classList.remove("piano-key-highlight"),Ce.update(e=>(e[t]=!1,e)),s[t]))try{n.stop()}catch(e){console.error("Errored stop, stopping all."),console.error("Error: ",e.message),d()}Ve.update(e=>(e[t]=[],e))}}else u<90&&Ee.update(e=>e+10);else u<99&&Ee.update(e=>e+1);else u>=10&&Ee.update(e=>e-10);else u>=1&&Ee.update(e=>e-1);else i>=-2&&je.update(e=>e-1);else i<=2&&je.update(e=>e+1)}}}return new class extends $e{constructor(e){super(),pe(this,e,Fn,jn,i,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
