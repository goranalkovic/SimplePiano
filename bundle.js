var app=function(){"use strict";function noop(){}const identity=e=>e;function assign(e,t){for(const n in t)e[n]=t[n];return e}function run(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run)}function is_function(e){return"function"==typeof e}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function subscribe(e,t,n){const r=t.subscribe(n);e.$$.on_destroy.push(r.unsubscribe?()=>r.unsubscribe():r)}function create_slot(e,t,n){if(e){const r=get_slot_context(e,t,n);return e[0](r)}}function get_slot_context(e,t,n){return e[1]?assign({},assign(t.$$scope.ctx,e[1](n?n(t):{}))):t.$$scope.ctx}function get_slot_changes(e,t,n,r){return e[1]?assign({},assign(t.$$scope.changed||{},e[1](r?r(n):{}))):t.$$scope.changed||{}}const is_client="undefined"!=typeof window;let now=is_client?()=>window.performance.now():()=>Date.now(),raf=e=>requestAnimationFrame(e);const tasks=new Set;let running=!1,stylesheet;function run_tasks(){tasks.forEach(e=>{e[0](now())||(tasks.delete(e),e[1]())}),(running=tasks.size>0)&&raf(run_tasks)}function loop(e){let t;return running||(running=!0,raf(run_tasks)),{promise:new Promise(n=>{tasks.add(t=[e,n])}),abort(){tasks.delete(t)}}}function append(e,t){e.appendChild(t)}function insert(e,t,n){e.insertBefore(t,n||null)}function detach(e){e.parentNode.removeChild(e)}function destroy_each(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function element(e){return document.createElement(e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function empty(){return text("")}function listen(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function attr(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function to_number(e){return""===e?void 0:+e}function children(e){return Array.from(e.childNodes)}function set_data(e,t){t=""+t,e.data!==t&&(e.data=t)}function set_style(e,t,n){e.style.setProperty(t,n)}function toggle_class(e,t,n){e.classList[n?"add":"remove"](t)}function custom_event(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}let active=0,current_rules={},current_component;function hash(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function create_rule(e,t,n,r,o,a,s,i=0){const c=16.666/r;let l="{\n";for(let e=0;e<=1;e+=c){const r=t+(n-t)*a(e);l+=100*e+`%{${s(r,1-r)}}\n`}const u=l+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${hash(u)}_${i}`;if(!current_rules[d]){if(!stylesheet){const e=element("style");document.head.appendChild(e),stylesheet=e.sheet}current_rules[d]=!0,stylesheet.insertRule(`@keyframes ${d} ${u}`,stylesheet.cssRules.length)}const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${d} ${r}ms linear ${o}ms 1 both`,active+=1,d}function delete_rule(e,t){e.style.animation=(e.style.animation||"").split(", ").filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")).join(", "),t&&!--active&&clear_rules()}function clear_rules(){raf(()=>{if(active)return;let e=stylesheet.cssRules.length;for(;e--;)stylesheet.deleteRule(e);current_rules={}})}function create_animation(e,t,n,r){if(!t)return noop;const o=e.getBoundingClientRect();if(t.left===o.left&&t.right===o.right&&t.top===o.top&&t.bottom===o.bottom)return noop;const{delay:a=0,duration:s=300,easing:i=identity,start:c=now()+a,end:l=c+s,tick:u=noop,css:d}=n(e,{from:t,to:o},r);let f,p=!0,m=!1;function _(){d&&delete_rule(e,f),p=!1}return loop(e=>{if(!m&&e>=c&&(m=!0),m&&e>=l&&(u(1,0),_()),!p)return!1;if(m){const t=0+1*i((e-c)/s);u(t,1-t)}return!0}),d&&(f=create_rule(e,0,1,s,a,i,d)),a||(m=!0),u(0,1),_}function fix_position(e){const t=getComputedStyle(e);if("absolute"!==t.position&&"fixed"!==t.position){const{width:n,height:r}=t,o=e.getBoundingClientRect();e.style.position="absolute",e.style.width=n,e.style.height=r,add_transform(e,o)}}function add_transform(e,t){const n=e.getBoundingClientRect();if(t.left!==n.left||t.top!==n.top){const r=getComputedStyle(e),o="none"===r.transform?"":r.transform;e.style.transform=`${o} translate(${t.left-n.left}px, ${t.top-n.top}px)`}}function set_current_component(e){current_component=e}function bubble(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const dirty_components=[],binding_callbacks=[],render_callbacks=[],flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1,promise;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(e){render_callbacks.push(e)}function add_flush_callback(e){flush_callbacks.push(e)}function flush(){const e=new Set;do{for(;dirty_components.length;){const e=dirty_components.shift();set_current_component(e),update(e.$$)}for(;binding_callbacks.length;)binding_callbacks.pop()();for(let t=0;t<render_callbacks.length;t+=1){const n=render_callbacks[t];e.has(n)||(n(),e.add(n))}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1}function update(e){e.fragment&&(e.update(e.dirty),run_all(e.before_update),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(add_render_callback))}function wait(){return promise||(promise=Promise.resolve()).then(()=>{promise=null}),promise}function dispatch(e,t,n){e.dispatchEvent(custom_event(`${t?"intro":"outro"}${n}`))}const outroing=new Set;let outros;function group_outros(){outros={remaining:0,callbacks:[]}}function check_outros(){outros.remaining||run_all(outros.callbacks)}function transition_in(e,t){e&&e.i&&(outroing.delete(e),e.i(t))}function transition_out(e,t,n){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.callbacks.push(()=>{outroing.delete(e),n&&(e.d(1),n())}),e.o(t)}}function create_bidirectional_transition(e,t,n,r){let o=t(e,n),a=r?0:1,s=null,i=null,c=null;function l(){c&&delete_rule(e,c)}function u(e,t){const n=e.b-a;return t*=Math.abs(n),{a:a,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function d(t){const{delay:n=0,duration:r=300,easing:d=identity,tick:f=noop,css:p}=o,m={start:now()+n,b:t};t||(m.group=outros,outros.remaining+=1),s?i=m:(p&&(l(),c=create_rule(e,a,t,r,n,d,p)),t&&f(0,1),s=u(m,r),add_render_callback(()=>dispatch(e,t,"start")),loop(t=>{if(i&&t>i.start&&(s=u(i,r),i=null,dispatch(e,s.b,"start"),p&&(l(),c=create_rule(e,a,s.b,s.duration,0,d,o.css))),s)if(t>=s.end)f(a=s.b,1-a),dispatch(e,s.b,"end"),i||(s.b?l():--s.group.remaining||run_all(s.group.callbacks)),s=null;else if(t>=s.start){const e=t-s.start;a=s.a+s.d*d(e/s.duration),f(a,1-a)}return!(!s&&!i)}))}return{run(e){is_function(o)?wait().then(()=>{o=o(),d(e)}):d(e)},end(){l(),s=i=null}}}const globals="undefined"!=typeof window?window:global;function outro_and_destroy_block(e,t){transition_out(e,1,()=>{t.delete(e.key)})}function fix_and_outro_and_destroy_block(e,t){e.f(),outro_and_destroy_block(e,t)}function update_keyed_each(e,t,n,r,o,a,s,i,c,l,u,d){let f=e.length,p=a.length,m=f;const _={};for(;m--;)_[e[m].key]=m;const h=[],v=new Map,g=new Map;for(m=p;m--;){const e=d(o,a,m),i=n(e);let c=s.get(i);c?r&&c.p(t,e):(c=l(i,e)).c(),v.set(i,h[m]=c),i in _&&g.set(i,Math.abs(m-_[i]))}const $=new Set,b=new Set;function y(e){transition_in(e,1),e.m(i,u),s.set(e.key,e),u=e.first,p--}for(;f&&p;){const t=h[p-1],n=e[f-1],r=t.key,o=n.key;t===n?(u=t.first,f--,p--):v.has(o)?!s.has(r)||$.has(r)?y(t):b.has(o)?f--:g.get(r)>g.get(o)?(b.add(r),y(t)):($.add(o),f--):(c(n,s),f--)}for(;f--;){const t=e[f];v.has(t.key)||c(t,s)}for(;p;)y(h[p-1]);return h}function get_spread_update(e,t){const n={},r={},o={$$scope:1};let a=e.length;for(;a--;){const s=e[a],i=t[a];if(i){for(const e in s)e in i||(r[e]=1);for(const e in i)o[e]||(n[e]=i[e],o[e]=1);e[a]=i}else for(const e in s)o[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function bind(e,t,n){-1!==e.$$.props.indexOf(t)&&(e.$$.bound[t]=n,n(e.$$.ctx[t]))}function mount_component(e,t,n){const{fragment:r,on_mount:o,on_destroy:a,after_update:s}=e.$$;r.m(t,n),add_render_callback(()=>{const t=o.map(run).filter(is_function);a?a.push(...t):run_all(t),e.$$.on_mount=[]}),s.forEach(add_render_callback)}function destroy_component(e,t){e.$$.fragment&&(run_all(e.$$.on_destroy),e.$$.fragment.d(t),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={})}function make_dirty(e,t){e.$$.dirty||(dirty_components.push(e),schedule_update(),e.$$.dirty=blank_object()),e.$$.dirty[t]=!0}function init(e,t,n,r,o,a){const s=current_component;set_current_component(e);const i=t.props||{},c=e.$$={fragment:null,ctx:null,props:a,update:noop,not_equal:o,bound:blank_object(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(s?s.$$.context:[]),callbacks:blank_object(),dirty:null};let l=!1;c.ctx=n?n(e,i,(t,n)=>{c.ctx&&o(c.ctx[t],c.ctx[t]=n)&&(c.bound[t]&&c.bound[t](n),l&&make_dirty(e,t))}):i,c.update(),l=!0,run_all(c.before_update),c.fragment=r(c.ctx),t.target&&(t.hydrate?c.fragment.l(children(t.target)):c.fragment.c(),t.intro&&transition_in(e.$$.fragment),mount_component(e,t.target,t.anchor),flush()),set_current_component(s)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function create_fragment(e){var t,n,r;const o=e.$$slots.default,a=create_slot(o,e,null);return{c(){t=element("button"),a&&a.c(),attr(t,"style",e.style),attr(t,"class","svelte-3qaunt"),toggle_class(t,"spaced",e.spaced),toggle_class(t,"outline",e.outline),r=listen(t,"click",e.click_handler)},l(e){a&&a.l(button_nodes)},m(e,r){insert(e,t,r),a&&a.m(t,null),n=!0},p(e,r){a&&a.p&&e.$$scope&&a.p(get_slot_changes(o,r,e,null),get_slot_context(o,r,null)),n&&!e.style||attr(t,"style",r.style),e.spaced&&toggle_class(t,"spaced",r.spaced),e.outline&&toggle_class(t,"outline",r.outline)},i(e){n||(transition_in(a,e),n=!0)},o(e){transition_out(a,e),n=!1},d(e){e&&detach(t),a&&a.d(e),r()}}}function instance(e,t,n){let{spaced:r=!1,style:o=null,outline:a=!1}=t,{$$slots:s={},$$scope:i}=t;return e.$set=(e=>{"spaced"in e&&n("spaced",r=e.spaced),"style"in e&&n("style",o=e.style),"outline"in e&&n("outline",a=e.outline),"$$scope"in e&&n("$$scope",i=e.$$scope)}),{spaced:r,style:o,outline:a,click_handler:function(t){bubble(e,t)},$$slots:s,$$scope:i}}class Button extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,["spaced","style","outline"])}}const get_left_slot_changes=()=>({}),get_left_slot_context=()=>({});function create_fragment$1(e){var t,n,r,o;const a=e.$$slots.left,s=create_slot(a,e,get_left_slot_context),i=e.$$slots.default,c=create_slot(i,e,null);return{c(){t=element("div"),s&&s.c(),n=space(),r=element("div"),c&&c.c(),attr(r,"class","right svelte-16m5xgj"),attr(t,"class","titlebar svelte-16m5xgj")},l(e){s&&s.l(div1_nodes),c&&c.l(div0_nodes)},m(e,a){insert(e,t,a),s&&s.m(t,null),append(t,n),append(t,r),c&&c.m(r,null),o=!0},p(e,t){s&&s.p&&e.$$scope&&s.p(get_slot_changes(a,t,e,get_left_slot_changes),get_slot_context(a,t,get_left_slot_context)),c&&c.p&&e.$$scope&&c.p(get_slot_changes(i,t,e,null),get_slot_context(i,t,null))},i(e){o||(transition_in(s,e),transition_in(c,e),o=!0)},o(e){transition_out(s,e),transition_out(c,e),o=!1},d(e){e&&detach(t),s&&s.d(e),c&&c.d(e)}}}function instance$1(e,t,n){let{$$slots:r={},$$scope:o}=t;return e.$set=(e=>{"$$scope"in e&&n("$$scope",o=e.$$scope)}),{$$slots:r,$$scope:o}}class TitleBar extends SvelteComponent{constructor(e){super(),init(this,e,instance$1,create_fragment$1,safe_not_equal,[])}}function writable(e,t=noop){let n;const r=[];function o(t){if(safe_not_equal(e,t)){if(e=t,!n)return;r.forEach(e=>e[1]()),r.forEach(t=>t[0](e))}}return{set:o,update:function(t){o(t(e))},subscribe:function(a,s=noop){const i=[a,s];return r.push(i),1===r.length&&(n=t(o)||noop),a(e),()=>{const e=r.indexOf(i);-1!==e&&r.splice(e,1),0===r.length&&(n(),n=null)}}}}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var assign$1=make_assign(),create=make_create(),trim=make_trim(),Global="undefined"!=typeof window?window:commonjsGlobal,util={assign:assign$1,create:create,trim:trim,bind:bind$1,slice:slice,each:each,map:map,pluck:pluck,isList:isList,isFunction:isFunction,isObject:isObject,Global:Global};function make_assign(){return Object.assign?Object.assign:function(e,t,n,r){for(var o=1;o<arguments.length;o++)each(Object(arguments[o]),function(t,n){e[n]=t});return e}}function make_create(){if(Object.create)return function(e,t,n,r){var o=slice(arguments,1);return assign$1.apply(this,[Object.create(e)].concat(o))};{function e(){}return function(t,n,r,o){var a=slice(arguments,1);return e.prototype=t,assign$1.apply(this,[new e].concat(a))}}}function make_trim(){return String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function bind$1(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}}function slice(e,t){return Array.prototype.slice.call(e,t||0)}function each(e,t){pluck(e,function(e,n){return t(e,n),!1})}function map(e,t){var n=isList(e)?[]:{};return pluck(e,function(e,r){return n[r]=t(e,r),!1}),n}function pluck(e,t){if(isList(e)){for(var n=0;n<e.length;n++)if(t(e[n],n))return e[n]}else for(var r in e)if(e.hasOwnProperty(r)&&t(e[r],r))return e[r]}function isList(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}function isFunction(e){return e&&"[object Function]"==={}.toString.call(e)}function isObject(e){return e&&"[object Object]"==={}.toString.call(e)}var slice$1=util.slice,pluck$1=util.pluck,each$1=util.each,bind$2=util.bind,create$1=util.create,isList$1=util.isList,isFunction$1=util.isFunction,isObject$1=util.isObject,storeEngine={createStore:createStore},storeAPI={version:"2.0.12",enabled:!1,get:function(e,t){var n=this.storage.read(this._namespacePrefix+e);return this._deserialize(n,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each(function(n,r){e.call(t,t._deserialize(n),(r||"").replace(t._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return createStore.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return createStore(this.storage,this.plugins,e)}};function _warn(){var e="undefined"==typeof console?null:console;e&&(e.warn?e.warn:e.log).apply(e,arguments)}function createStore(e,t,n){n||(n=""),e&&!isList$1(e)&&(e=[e]),t&&!isList$1(t)&&(t=[t]);var r=n?"__storejs_"+n+"_":"",o=n?new RegExp("^"+r):null;if(!/^[a-zA-Z0-9_\-]*$/.test(n))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var a=create$1({_namespacePrefix:r,_namespaceRegexp:o,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var n=e.read(t)===t;return e.remove(t),n}catch(e){return!1}},_assignPluginFnProp:function(e,t){var n=this[t];this[t]=function(){var t=slice$1(arguments,0),r=this;var o=[function(){if(n)return each$1(arguments,function(e,n){t[n]=e}),n.apply(r,t)}].concat(t);return e.apply(r,o)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var n="";try{n=JSON.parse(e)}catch(t){n=e}return void 0!==n?n:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(isList$1(e))each$1(e,function(e){t._addPlugin(e)});else if(!pluck$1(this.plugins,function(t){return e===t})){if(this.plugins.push(e),!isFunction$1(e))throw new Error("Plugins must be function values that return objects");var n=e.call(this);if(!isObject$1(n))throw new Error("Plugins must return an object of function properties");each$1(n,function(n,r){if(!isFunction$1(n))throw new Error("Bad plugin property: "+r+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(n,r)})}},addStorage:function(e){_warn("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},storeAPI,{plugins:[]});return a.raw={},each$1(a,function(e,t){isFunction$1(e)&&(a.raw[t]=bind$2(a,e))}),each$1(e,function(e){a._addStorage(e)}),each$1(t,function(e){a._addPlugin(e)}),a}var Global$1=util.Global,localStorage_1={name:"localStorage",read:read,write:write,each:each$2,remove:remove,clearAll:clearAll};function localStorage(){return Global$1.localStorage}function read(e){return localStorage().getItem(e)}function write(e,t){return localStorage().setItem(e,t)}function each$2(e){for(var t=localStorage().length-1;t>=0;t--){var n=localStorage().key(t);e(read(n),n)}}function remove(e){return localStorage().removeItem(e)}function clearAll(){return localStorage().clear()}var Global$2=util.Global,oldFFGlobalStorage={name:"oldFF-globalStorage",read:read$1,write:write$1,each:each$3,remove:remove$1,clearAll:clearAll$1},globalStorage=Global$2.globalStorage;function read$1(e){return globalStorage[e]}function write$1(e,t){globalStorage[e]=t}function each$3(e){for(var t=globalStorage.length-1;t>=0;t--){var n=globalStorage.key(t);e(globalStorage[n],n)}}function remove$1(e){return globalStorage.removeItem(e)}function clearAll$1(){each$3(function(e,t){delete globalStorage[e]})}var Global$3=util.Global,oldIEUserDataStorage={name:"oldIE-userDataStorage",write:write$2,read:read$2,each:each$4,remove:remove$2,clearAll:clearAll$2},storageName="storejs",doc=Global$3.document,_withStorageEl=_makeIEStorageElFunction(),disable=(Global$3.navigator?Global$3.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);function write$2(e,t){if(!disable){var n=fixKey(e);_withStorageEl(function(e){e.setAttribute(n,t),e.save(storageName)})}}function read$2(e){if(!disable){var t=fixKey(e),n=null;return _withStorageEl(function(e){n=e.getAttribute(t)}),n}}function each$4(e){_withStorageEl(function(t){for(var n=t.XMLDocument.documentElement.attributes,r=n.length-1;r>=0;r--){var o=n[r];e(t.getAttribute(o.name),o.name)}})}function remove$2(e){var t=fixKey(e);_withStorageEl(function(e){e.removeAttribute(t),e.save(storageName)})}function clearAll$2(){_withStorageEl(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(storageName);for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save(storageName)})}var forbiddenCharsRegex=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function fixKey(e){return e.replace(/^\d/,"___$&").replace(forbiddenCharsRegex,"___")}function _makeIEStorageElFunction(){if(!doc||!doc.documentElement||!doc.documentElement.addBehavior)return null;var e,t,n;try{(t=new ActiveXObject("htmlfile")).open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,n=e.createElement("div")}catch(t){n=doc.createElement("div"),e=doc.body}return function(t){var r=[].slice.call(arguments,0);r.unshift(n),e.appendChild(n),n.addBehavior("#default#userData"),n.load(storageName),t.apply(this,r),e.removeChild(n)}}var Global$4=util.Global,trim$1=util.trim,cookieStorage={name:"cookieStorage",read:read$3,write:write$3,each:each$5,remove:remove$3,clearAll:clearAll$3},doc$1=Global$4.document;function read$3(e){if(!e||!_has(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(doc$1.cookie.replace(new RegExp(t),"$1"))}function each$5(e){for(var t=doc$1.cookie.split(/; ?/g),n=t.length-1;n>=0;n--)if(trim$1(t[n])){var r=t[n].split("="),o=unescape(r[0]);e(unescape(r[1]),o)}}function write$3(e,t){e&&(doc$1.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")}function remove$3(e){e&&_has(e)&&(doc$1.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function clearAll$3(){each$5(function(e,t){remove$3(t)})}function _has(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(doc$1.cookie)}var Global$5=util.Global,sessionStorage_1={name:"sessionStorage",read:read$4,write:write$4,each:each$6,remove:remove$4,clearAll:clearAll$4};function sessionStorage(){return Global$5.sessionStorage}function read$4(e){return sessionStorage().getItem(e)}function write$4(e,t){return sessionStorage().setItem(e,t)}function each$6(e){for(var t=sessionStorage().length-1;t>=0;t--){var n=sessionStorage().key(t);e(read$4(n),n)}}function remove$4(e){return sessionStorage().removeItem(e)}function clearAll$4(){return sessionStorage().clear()}var memoryStorage_1={name:"memoryStorage",read:read$5,write:write$5,each:each$7,remove:remove$5,clearAll:clearAll$5},memoryStorage={};function read$5(e){return memoryStorage[e]}function write$5(e,t){memoryStorage[e]=t}function each$7(e){for(var t in memoryStorage)memoryStorage.hasOwnProperty(t)&&e(memoryStorage[t],t)}function remove$5(e){delete memoryStorage[e]}function clearAll$5(e){memoryStorage={}}var all=[localStorage_1,oldFFGlobalStorage,oldIEUserDataStorage,cookieStorage,sessionStorage_1,memoryStorage_1];"object"!=typeof JSON&&(JSON={}),function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,o,a,s,i=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(a=c.length,n=0;n<a;n+=1)s[n]=str(n,c)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+i+"]":"["+s.join(",")+"]",gap=i,o}if(rep&&"object"==typeof rep)for(a=rep.length,n=0;n<a;n+=1)"string"==typeof rep[n]&&(o=str(r=rep[n],c))&&s.push(quote(r)+(gap?": ":":")+o);else for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(o=str(r,c))&&s.push(quote(r)+(gap?": ":":")+o);return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+i+"}":"{"+s.join(",")+"}",gap=i,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var n,r,o=e[t];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(void 0!==(r=walk(o,n))?o[n]=r:delete o[n]);return reviver.call(e,t,o)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var json2=json2Plugin;function json2Plugin(){return{}}var plugins=[json2],store_legacy=storeEngine.createStore(all,plugins),lodash_clonedeep=createCommonjsModule(function(e,t){var n=200,r="__lodash_hash_undefined__",o=9007199254740991,a="[object Arguments]",s="[object Boolean]",i="[object Date]",c="[object Function]",l="[object GeneratorFunction]",u="[object Map]",d="[object Number]",f="[object Object]",p="[object RegExp]",m="[object Set]",_="[object String]",h="[object Symbol]",v="[object ArrayBuffer]",g="[object DataView]",$="[object Float32Array]",b="[object Float64Array]",y="[object Int8Array]",S="[object Int16Array]",k="[object Int32Array]",w="[object Uint8Array]",x="[object Uint8ClampedArray]",A="[object Uint16Array]",j="[object Uint32Array]",C=/\w*$/,E=/^\[object .+?Constructor\]$/,O=/^(?:0|[1-9]\d*)$/,T={};T[a]=T["[object Array]"]=T[v]=T[g]=T[s]=T[i]=T[$]=T[b]=T[y]=T[S]=T[k]=T[u]=T[d]=T[f]=T[p]=T[m]=T[_]=T[h]=T[w]=T[x]=T[A]=T[j]=!0,T["[object Error]"]=T[c]=T["[object WeakMap]"]=!1;var F="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,M="object"==typeof self&&self&&self.Object===Object&&self,N=F||M||Function("return this")(),P=t&&!t.nodeType&&t,V=P&&e&&!e.nodeType&&e,q=V&&V.exports===P;function D(e,t){return e.set(t[0],t[1]),e}function I(e,t){return e.add(t),e}function L(e,t,n,r){var o=-1,a=e?e.length:0;for(r&&a&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e);return n}function G(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function R(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function B(e,t){return function(n){return e(t(n))}}function U(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var z,K=Array.prototype,J=Function.prototype,W=Object.prototype,H=N["__core-js_shared__"],X=(z=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"",Z=J.toString,Y=W.hasOwnProperty,Q=W.toString,ee=RegExp("^"+Z.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=q?N.Buffer:void 0,ne=N.Symbol,re=N.Uint8Array,oe=B(Object.getPrototypeOf,Object),ae=Object.create,se=W.propertyIsEnumerable,ie=K.splice,ce=Object.getOwnPropertySymbols,le=te?te.isBuffer:void 0,ue=B(Object.keys,Object),de=Ve(N,"DataView"),fe=Ve(N,"Map"),pe=Ve(N,"Promise"),me=Ve(N,"Set"),_e=Ve(N,"WeakMap"),he=Ve(Object,"create"),ve=Ge(de),ge=Ge(fe),$e=Ge(pe),be=Ge(me),ye=Ge(_e),Se=ne?ne.prototype:void 0,ke=Se?Se.valueOf:void 0;function we(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function xe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ae(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function je(e){this.__data__=new xe(e)}function Ce(e,t){var n=Be(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ue(e)}(e)&&Y.call(e,"callee")&&(!se.call(e,"callee")||Q.call(e)==a)}(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,o=!!r;for(var s in e)!t&&!Y.call(e,s)||o&&("length"==s||Ie(s,r))||n.push(s);return n}function Ee(e,t,n){var r=e[t];Y.call(e,t)&&Re(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function Oe(e,t){for(var n=e.length;n--;)if(Re(e[n][0],t))return n;return-1}function Te(e,t,n,r,o,E,O){var F;if(r&&(F=E?r(e,o,E,O):r(e)),void 0!==F)return F;if(!Je(e))return e;var M=Be(e);if(M){if(F=function(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&Y.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!t)return function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(e,F)}else{var N=De(e),P=N==c||N==l;if(ze(e))return function(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}(e,t);if(N==f||N==a||P&&!E){if(G(e))return E?e:{};if(F=function(e){return"function"!=typeof e.constructor||Le(e)?{}:(t=oe(e),Je(t)?ae(t):{});var t}(P?{}:e),!t)return function(e,t){return Ne(e,qe(e),t)}(e,function(e,t){return e&&Ne(t,We(t),e)}(F,e))}else{if(!T[N])return E?e:{};F=function(e,t,n,r){var o=e.constructor;switch(t){case v:return Me(e);case s:case i:return new o(+e);case g:return function(e,t){var n=t?Me(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,r);case $:case b:case y:case S:case k:case w:case x:case A:case j:return function(e,t){var n=t?Me(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,r);case u:return function(e,t,n){return L(t?n(R(e),!0):R(e),D,new e.constructor)}(e,r,n);case d:case _:return new o(e);case p:return(l=new(c=e).constructor(c.source,C.exec(c))).lastIndex=c.lastIndex,l;case m:return function(e,t,n){return L(t?n(U(e),!0):U(e),I,new e.constructor)}(e,r,n);case h:return a=e,ke?Object(ke.call(a)):{}}var a;var c,l}(e,N,Te,t)}}O||(O=new je);var V=O.get(e);if(V)return V;if(O.set(e,F),!M)var q=n?function(e){return function(e,t,n){var r=t(e);return Be(e)?r:function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(r,n(e))}(e,We,qe)}(e):We(e);return function(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););}(q||e,function(o,a){q&&(o=e[a=o]),Ee(F,a,Te(o,t,n,r,a,e,O))}),F}function Fe(e){return!(!Je(e)||(t=e,X&&X in t))&&(Ke(e)||G(e)?ee:E).test(Ge(e));var t}function Me(e){var t=new e.constructor(e.byteLength);return new re(t).set(new re(e)),t}function Ne(e,t,n,r){n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],i=r?r(n[s],e[s],s,n,e):void 0;Ee(n,s,void 0===i?e[s]:i)}return n}function Pe(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function Ve(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Fe(n)?n:void 0}we.prototype.clear=function(){this.__data__=he?he(null):{}},we.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},we.prototype.get=function(e){var t=this.__data__;if(he){var n=t[e];return n===r?void 0:n}return Y.call(t,e)?t[e]:void 0},we.prototype.has=function(e){var t=this.__data__;return he?void 0!==t[e]:Y.call(t,e)},we.prototype.set=function(e,t){return this.__data__[e]=he&&void 0===t?r:t,this},xe.prototype.clear=function(){this.__data__=[]},xe.prototype.delete=function(e){var t=this.__data__,n=Oe(t,e);return!(n<0||(n==t.length-1?t.pop():ie.call(t,n,1),0))},xe.prototype.get=function(e){var t=this.__data__,n=Oe(t,e);return n<0?void 0:t[n][1]},xe.prototype.has=function(e){return Oe(this.__data__,e)>-1},xe.prototype.set=function(e,t){var n=this.__data__,r=Oe(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},Ae.prototype.clear=function(){this.__data__={hash:new we,map:new(fe||xe),string:new we}},Ae.prototype.delete=function(e){return Pe(this,e).delete(e)},Ae.prototype.get=function(e){return Pe(this,e).get(e)},Ae.prototype.has=function(e){return Pe(this,e).has(e)},Ae.prototype.set=function(e,t){return Pe(this,e).set(e,t),this},je.prototype.clear=function(){this.__data__=new xe},je.prototype.delete=function(e){return this.__data__.delete(e)},je.prototype.get=function(e){return this.__data__.get(e)},je.prototype.has=function(e){return this.__data__.has(e)},je.prototype.set=function(e,t){var r=this.__data__;if(r instanceof xe){var o=r.__data__;if(!fe||o.length<n-1)return o.push([e,t]),this;r=this.__data__=new Ae(o)}return r.set(e,t),this};var qe=ce?B(ce,Object):function(){return[]},De=function(e){return Q.call(e)};function Ie(e,t){return!!(t=null==t?o:t)&&("number"==typeof e||O.test(e))&&e>-1&&e%1==0&&e<t}function Le(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||W)}function Ge(e){if(null!=e){try{return Z.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Re(e,t){return e===t||e!=e&&t!=t}(de&&De(new de(new ArrayBuffer(1)))!=g||fe&&De(new fe)!=u||pe&&"[object Promise]"!=De(pe.resolve())||me&&De(new me)!=m||_e&&"[object WeakMap]"!=De(new _e))&&(De=function(e){var t=Q.call(e),n=t==f?e.constructor:void 0,r=n?Ge(n):void 0;if(r)switch(r){case ve:return g;case ge:return u;case $e:return"[object Promise]";case be:return m;case ye:return"[object WeakMap]"}return t});var Be=Array.isArray;function Ue(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}(e.length)&&!Ke(e)}var ze=le||function(){return!1};function Ke(e){var t=Je(e)?Q.call(e):"";return t==c||t==l}function Je(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function We(e){return Ue(e)?Ce(e):function(e){if(!Le(e))return ue(e);var t=[];for(var n in Object(e))Y.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}e.exports=function(e){return Te(e,!0,!0)}});const createWritableStore=(e,t)=>{const{subscribe:n,set:r}=writable(t);return{subscribe:n,set:r,useLocalStorage:()=>{const t=store_legacy.get(e);if("instruments"===e&&t){let e=[...t];for(let t of e)if(!(t.instruments.length<1))for(let e of t.instruments){let t=Soundfont.instrument(ac,e.name,{soundfont:e.soundfont});e.data=t}r(e)}t&&r(t),n(t=>{store_legacy.set(e,lodash_clonedeep(t))})}}},soundFont={fluid:"FluidR3_GM",mk:"MusyngKite",fatboy:"FatBoy"},keyCodes={20:"⇪",65:"A",83:"S",68:"D",70:"F",71:"G",72:"H",74:"J",75:"K",76:"L",186:"Č",222:"Ć",220:"Ž",13:"↵",81:"Q",87:"W",69:"E",84:"T",90:"Z",73:"I",79:"O",80:"P",221:"Đ",8:"⌫"},keyNotes={20:"53",65:"55",83:"57",68:"59",70:"60",71:"62",72:"64",74:"65",75:"67",76:"69",186:"71",222:"72",220:"74",13:"76",81:"54",87:"56",69:"58",84:"61",90:"63",73:"66",79:"68",80:"70",221:"73",8:"75"},keysPressed=writable({20:[],65:[],83:[],68:[],70:[],71:[],72:[],74:[],75:[],76:[],186:[],222:[],220:[],13:[],81:[],87:[],69:[],84:[],90:[],73:[],79:[],80:[],221:[],8:[]}),defaultAdsr=[.005,.395,.8,1.2],keysDown=writable({20:!1,65:!1,83:!1,68:!1,70:!1,71:!1,72:!1,74:!1,75:!1,76:!1,186:!1,222:!1,220:!1,13:!1,81:!1,87:!1,69:!1,84:!1,90:!1,73:!1,79:!1,80:!1,221:!1,8:!1});let ac=new AudioContext;const currentSoundFont=createWritableStore("currentSoundFont",soundFont.fatboy),activeSet=createWritableStore("activeSet",0),volume=createWritableStore("volume",25),octaveShift=createWritableStore("octaveShift",0),showAdsr=createWritableStore("showAdsr",!1),isFocused=writable(!1),instrumentSets=createWritableStore("instruments",[{name:"Set 1",instruments:[]},{name:"Set 2",instruments:[]},{name:"Set 3",instruments:[]},{name:"Set 4",instruments:[]},{name:"Set 5",instruments:[]},{name:"Set 6",instruments:[]},{name:"Set 7",instruments:[]},{name:"Set 8",instruments:[]},{name:"Set 9",instruments:[]},{name:"Set 10",instruments:[]}]);function create_if_block(e){var t,n;return{c(){t=element("span"),n=text(e.label),attr(t,"class","label svelte-1yd4dop")},m(e,r){insert(e,t,r),append(t,n)},p(e,t){e.label&&set_data(n,t.label)},d(e){e&&detach(t)}}}function create_fragment$2(e){var t,n,r,o=e.label&&create_if_block(e);return{c(){t=element("div"),o&&o.c(),n=space(),attr(r=element("span"),"class","keyboard-key svelte-1yd4dop"),toggle_class(r,"square",e.square),attr(t,"class","container svelte-1yd4dop")},m(a,s){insert(a,t,s),o&&o.m(t,null),append(t,n),append(t,r),r.innerHTML=e.key},p(e,a){a.label?o?o.p(e,a):((o=create_if_block(a)).c(),o.m(t,n)):o&&(o.d(1),o=null),e.key&&(r.innerHTML=a.key),e.square&&toggle_class(r,"square",a.square)},i:noop,o:noop,d(e){e&&detach(t),o&&o.d()}}}function instance$2(e,t,n){let{label:r=null,key:o,square:a=!0}=t;return e.$set=(e=>{"label"in e&&n("label",r=e.label),"key"in e&&n("key",o=e.key),"square"in e&&n("square",a=e.square)}),{label:r,key:o,square:a}}class KeyboardKey extends SvelteComponent{constructor(e){super(),init(this,e,instance$2,create_fragment$2,safe_not_equal,["label","key","square"])}}function get_each_context(e,t,n){const r=Object.create(e);return r.kbKey=t[n],r}function create_if_block$1(e){for(var t,n,r=e.keyboardKeys,o=[],a=0;a<r.length;a+=1)o[a]=create_each_block(get_each_context(e,r,a));const s=e=>transition_out(o[e],1,()=>{o[e]=null});return{c(){t=element("div");for(var e=0;e<o.length;e+=1)o[e].c();attr(t,"class","hints svelte-aqi3n7")},m(e,r){insert(e,t,r);for(var a=0;a<o.length;a+=1)o[a].m(t,null);n=!0},p(e,n){if(e.keyboardKeys){r=n.keyboardKeys;for(var a=0;a<r.length;a+=1){const s=get_each_context(n,r,a);o[a]?(o[a].p(e,s),transition_in(o[a],1)):(o[a]=create_each_block(s),o[a].c(),transition_in(o[a],1),o[a].m(t,null))}for(group_outros(),a=r.length;a<o.length;a+=1)s(a);check_outros()}},i(e){if(!n){for(var t=0;t<r.length;t+=1)transition_in(o[t]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)transition_out(o[e]);n=!1},d(e){e&&detach(t),destroy_each(o,e)}}}function create_each_block(e){var t,n=[e.kbKey];let r={};for(var o=0;o<n.length;o+=1)r=assign(r,n[o]);var a=new KeyboardKey({props:r});return{c(){a.$$.fragment.c()},m(e,n){mount_component(a,e,n),t=!0},p(e,t){var r=e.keyboardKeys?get_spread_update(n,[t.kbKey]):{};a.$set(r)},i(e){t||(transition_in(a.$$.fragment,e),t=!0)},o(e){transition_out(a.$$.fragment,e),t=!1},d(e){destroy_component(a,e)}}}function create_fragment$3(e){var t,n,r,o,a,s,i,c,l,u,d,f,p=e.keyboardKeys&&hovering&&create_if_block$1(e);return{c(){t=element("div"),n=element("label"),r=element("span"),o=text(e.title),a=space(),s=element("input"),i=space(),c=element("span"),l=text(e.formattedValue),u=space(),p&&p.c(),attr(r,"class","title svelte-aqi3n7"),attr(s,"type","range"),attr(s,"min",e.min),attr(s,"max",e.max),attr(s,"step",e.step),attr(s,"class","svelte-aqi3n7"),attr(c,"class","value svelte-aqi3n7"),attr(t,"class","slide-ctrl svelte-aqi3n7"),f=[listen(s,"change",e.input_change_input_handler),listen(s,"input",e.input_change_input_handler),listen(s,"change",e.change_handler)]},m(f,m){insert(f,t,m),append(t,n),append(n,r),append(r,o),append(n,a),append(n,s),s.value=e.value,append(n,i),append(n,c),append(c,l),append(t,u),p&&p.m(t,null),d=!0},p(e,n){d&&!e.title||set_data(o,n.title),e.value&&(s.value=n.value),d&&!e.min||attr(s,"min",n.min),d&&!e.max||attr(s,"max",n.max),d&&!e.step||attr(s,"step",n.step),d&&!e.formattedValue||set_data(l,n.formattedValue),n.keyboardKeys&&hovering?p?(p.p(e,n),transition_in(p,1)):((p=create_if_block$1(n)).c(),transition_in(p,1),p.m(t,null)):p&&(group_outros(),transition_out(p,1,()=>{p=null}),check_outros())},i(e){d||(transition_in(p),d=!0)},o(e){transition_out(p),d=!1},d(e){e&&detach(t),p&&p.d(),run_all(f)}}}let hovering=!1;function instance$3(e,t,n){let r,{title:o,min:a,max:s,step:i,value:c,keyboardKeys:l=null,customValueDisplay:u=null}=t;return e.$set=(e=>{"title"in e&&n("title",o=e.title),"min"in e&&n("min",a=e.min),"max"in e&&n("max",s=e.max),"step"in e&&n("step",i=e.step),"value"in e&&n("value",c=e.value),"keyboardKeys"in e&&n("keyboardKeys",l=e.keyboardKeys),"customValueDisplay"in e&&n("customValueDisplay",u=e.customValueDisplay)}),e.$$.update=((e={customValueDisplay:1,value:1})=>{(e.customValueDisplay||e.value)&&n("formattedValue",r=null!=u&&null!=u[c]?u[c]:c)}),{title:o,min:a,max:s,step:i,value:c,keyboardKeys:l,customValueDisplay:u,formattedValue:r,change_handler:function(t){bubble(e,t)},input_change_input_handler:function(){c=to_number(this.value),n("value",c)}}}class SlideControl extends SvelteComponent{constructor(e){super(),init(this,e,instance$3,create_fragment$3,safe_not_equal,["title","min","max","step","value","keyboardKeys","customValueDisplay"])}}function create_fragment$4(e){var t,n,r,o,a,s,i,c=[e.volumeControl];function l(t){e.slidecontrol0_value_binding.call(null,t),n=!0,add_flush_callback(()=>n=!1)}let u={};for(var d=0;d<c.length;d+=1)u=assign(u,c[d]);void 0!==e.$volume&&(u.value=e.$volume);var f=new SlideControl({props:u});binding_callbacks.push(()=>bind(f,"value",l));var p=[e.octaveControl];function m(t){e.slidecontrol1_value_binding.call(null,t),s=!0,add_flush_callback(()=>s=!1)}let _={};for(d=0;d<p.length;d+=1)_=assign(_,p[d]);void 0!==e.$octaveShift&&(_.value=e.$octaveShift);var h=new SlideControl({props:_});return binding_callbacks.push(()=>bind(h,"value",m)),{c(){t=element("div"),f.$$.fragment.c(),r=space(),o=element("div"),a=space(),h.$$.fragment.c(),attr(o,"class","spacer svelte-11xn1wc"),attr(t,"class","flex svelte-11xn1wc")},m(e,n){insert(e,t,n),mount_component(f,t,null),append(t,r),append(t,o),append(t,a),mount_component(h,t,null),i=!0},p(e,t){var r=e.volumeControl?get_spread_update(c,[t.volumeControl]):{};!n&&e.$volume&&(r.value=t.$volume),f.$set(r);var o=e.octaveControl?get_spread_update(p,[t.octaveControl]):{};!s&&e.$octaveShift&&(o.value=t.$octaveShift),h.$set(o)},i(e){i||(transition_in(f.$$.fragment,e),transition_in(h.$$.fragment,e),i=!0)},o(e){transition_out(f.$$.fragment,e),transition_out(h.$$.fragment,e),i=!1},d(e){e&&detach(t),destroy_component(f),destroy_component(h)}}}function instance$4(e,t,n){let r,o;subscribe(e,volume,e=>{n("$volume",r=e)}),subscribe(e,octaveShift,e=>{n("$octaveShift",o=e)});return{volumeControl:{title:"Volume",min:0,max:100,step:1,keyboardKeys:[{label:"-1",key:"←"},{label:"+1",key:"→"},{label:"+10",key:"↑"},{label:"-10",key:"↓"}]},octaveControl:{title:"Octave shift",min:-3,max:3,step:.5,keyboardKeys:[{label:"Up",key:"⇧",square:!1},{label:"Dn",key:"<small>Ctrl</small>",square:!1}]},$volume:r,$octaveShift:o,slidecontrol0_value_binding:function(e){r=e,volume.set(r)},slidecontrol1_value_binding:function(e){o=e,octaveShift.set(o)}}}class Controls extends SvelteComponent{constructor(e){super(),init(this,e,instance$4,create_fragment$4,safe_not_equal,[])}}function create_fragment$5(e){var t,n,r,o,a;return{c(){t=element("div"),(n=element("div")).innerHTML='<div id="⇪" class="white-key svelte-6c6krm">⇪</div> <div id="A" class="white-key svelte-6c6krm">A</div> <div id="S" class="white-key svelte-6c6krm">S</div> <div id="D" class="white-key svelte-6c6krm">D</div> <div id="F" class="white-key svelte-6c6krm">F</div> <div id="G" class="white-key svelte-6c6krm">G</div> <div id="H" class="white-key svelte-6c6krm">H</div> <div id="J" class="white-key svelte-6c6krm">J</div> <div id="K" class="white-key svelte-6c6krm">K</div> <div id="L" class="white-key svelte-6c6krm">L</div> <div id="Č" class="white-key svelte-6c6krm">Č</div> <div id="Ć" class="white-key svelte-6c6krm">Ć</div> <div id="Ž" class="white-key svelte-6c6krm">Ž</div> <div id="↵" class="white-key svelte-6c6krm">↵</div>',r=space(),(o=element("div")).innerHTML='<div id="Q" class="black-key svelte-6c6krm">Q</div> <div id="W" class="black-key svelte-6c6krm">W</div> <div id="E" class="black-key svelte-6c6krm">E</div> <div class="blank-black-key svelte-6c6krm"></div> <div id="T" class="black-key svelte-6c6krm">T</div> <div id="Z" class="black-key svelte-6c6krm">Z</div> <div class="blank-black-key svelte-6c6krm"></div> <div id="I" class="black-key svelte-6c6krm">I</div> <div id="O" class="black-key svelte-6c6krm">O</div> <div id="P" class="black-key svelte-6c6krm">P</div> <div class="blank-black-key svelte-6c6krm"></div> <div id="Đ" class="black-key svelte-6c6krm">Đ</div> <div id="⌫" class="black-key svelte-6c6krm">⌫</div>',attr(n,"class","piano-grid svelte-6c6krm"),attr(o,"class","piano-grid svelte-6c6krm"),attr(t,"class",a="piano-grid-container "+(e.$isFocused?"transparent":"")+" svelte-6c6krm")},m(e,a){insert(e,t,a),append(t,n),append(t,r),append(t,o)},p(e,n){e.$isFocused&&a!==(a="piano-grid-container "+(n.$isFocused?"transparent":"")+" svelte-6c6krm")&&attr(t,"class",a)},i:noop,o:noop,d(e){e&&detach(t)}}}function instance$5(e,t,n){let r;return subscribe(e,isFocused,e=>{n("$isFocused",r=e)}),{$isFocused:r}}class PianoGrid extends SvelteComponent{constructor(e){super(),init(this,e,instance$5,create_fragment$5,safe_not_equal,[])}}function cubicOut(e){const t=e-1;return t*t*t+1}function slide(e,{delay:t=0,duration:n=400,easing:r=cubicOut}){const o=getComputedStyle(e),a=+o.opacity,s=parseFloat(o.height),i=parseFloat(o.paddingTop),c=parseFloat(o.paddingBottom),l=parseFloat(o.marginTop),u=parseFloat(o.marginBottom),d=parseFloat(o.borderTopWidth),f=parseFloat(o.borderBottomWidth);return{delay:t,duration:n,easing:r,css:e=>"overflow: hidden;"+`opacity: ${Math.min(20*e,1)*a};`+`height: ${e*s}px;`+`padding-top: ${e*i}px;`+`padding-bottom: ${e*c}px;`+`margin-top: ${e*l}px;`+`margin-bottom: ${e*u}px;`+`border-top-width: ${e*d}px;`+`border-bottom-width: ${e*f}px;`}}function flip(e,t,n){const r=getComputedStyle(e),o="none"===r.transform?"":r.transform,a=t.from.left-t.to.left,s=t.from.top-t.to.top,i=Math.sqrt(a*a+s*s),{delay:c=0,duration:l=(e=>120*Math.sqrt(e)),easing:u=cubicOut}=n;return{delay:c,duration:is_function(l)?l(i):l,easing:u,css:(e,t)=>`transform: ${o} translate(${t*a}px, ${t*s}px);`}}function create_else_block(e){var t,n,r,o,a;const s=e.$$slots.default,i=create_slot(s,e,null);return{c(){t=element("div"),i&&i.c(),attr(t,"animation:flip",{duration:300}),attr(t,"class",n="card "+e.addClass+" svelte-1tei9xx"),toggle_class(t,"active",e.active),toggle_class(t,"disabled",e.disabled&&!e.active),toggle_class(t,"selectable",e.selectable),a=[listen(t,"click",e.click_handler),listen(t,"mouseover",e.mouseover_handler_1),listen(t,"mouseleave",e.mouseleave_handler_1)]},l(e){i&&i.l(div_nodes)},m(e,n){insert(e,t,n),i&&i.m(t,null),o=!0},p(e,r){i&&i.p&&e.$$scope&&i.p(get_slot_changes(s,r,e,null),get_slot_context(s,r,null)),o&&!e.addClass||n===(n="card "+r.addClass+" svelte-1tei9xx")||attr(t,"class",n),(e.addClass||e.active)&&toggle_class(t,"active",r.active),(e.addClass||e.disabled||e.active)&&toggle_class(t,"disabled",r.disabled&&!r.active),(e.addClass||e.selectable)&&toggle_class(t,"selectable",r.selectable)},i(e){o||(transition_in(i,e),add_render_callback(()=>{r||(r=create_bidirectional_transition(t,slide,{},!0)),r.run(1)}),o=!0)},o(e){transition_out(i,e),r||(r=create_bidirectional_transition(t,slide,{},!1)),r.run(0),o=!1},d(e){e&&detach(t),i&&i.d(e),e&&r&&r.end(),run_all(a)}}}function create_if_block$2(e){var t,n,r,o,a;const s=e.$$slots.default,i=create_slot(s,e,null);return{c(){t=element("div"),i&&i.c(),attr(t,"animation:flip",{duration:300}),attr(t,"class",n="card passive "+e.addClass+" svelte-1tei9xx"),toggle_class(t,"active",e.active),toggle_class(t,"disabled",e.disabled),toggle_class(t,"selectable",e.selectable),a=[listen(t,"mouseover",e.mouseover_handler),listen(t,"mouseleave",e.mouseleave_handler)]},l(e){i&&i.l(div_nodes)},m(e,n){insert(e,t,n),i&&i.m(t,null),o=!0},p(e,r){i&&i.p&&e.$$scope&&i.p(get_slot_changes(s,r,e,null),get_slot_context(s,r,null)),o&&!e.addClass||n===(n="card passive "+r.addClass+" svelte-1tei9xx")||attr(t,"class",n),(e.addClass||e.active)&&toggle_class(t,"active",r.active),(e.addClass||e.disabled)&&toggle_class(t,"disabled",r.disabled),(e.addClass||e.selectable)&&toggle_class(t,"selectable",r.selectable)},i(e){o||(transition_in(i,e),add_render_callback(()=>{r||(r=create_bidirectional_transition(t,slide,{},!0)),r.run(1)}),o=!0)},o(e){transition_out(i,e),r||(r=create_bidirectional_transition(t,slide,{},!1)),r.run(0),o=!1},d(e){e&&detach(t),i&&i.d(e),e&&r&&r.end(),run_all(a)}}}function create_fragment$6(e){var t,n,r,o,a=[create_if_block$2,create_else_block],s=[];function i(e){return e.passive?0:1}return t=i(e),n=s[t]=a[t](e),{c(){n.c(),r=empty()},m(e,n){s[t].m(e,n),insert(e,r,n),o=!0},p(e,o){var c=t;(t=i(o))===c?s[t].p(e,o):(group_outros(),transition_out(s[c],1,()=>{s[c]=null}),check_outros(),(n=s[t])||(n=s[t]=a[t](o)).c(),transition_in(n,1),n.m(r.parentNode,r))},i(e){o||(transition_in(n),o=!0)},o(e){transition_out(n),o=!1},d(e){s[t].d(e),e&&detach(r)}}}function instance$6(e,t,n){let{disabled:r=!1,active:o=!1,selectable:a=!1,passive:s=!0,addClass:i=""}=t,{$$slots:c={},$$scope:l}=t;return e.$set=(e=>{"disabled"in e&&n("disabled",r=e.disabled),"active"in e&&n("active",o=e.active),"selectable"in e&&n("selectable",a=e.selectable),"passive"in e&&n("passive",s=e.passive),"addClass"in e&&n("addClass",i=e.addClass),"$$scope"in e&&n("$$scope",l=e.$$scope)}),{disabled:r,active:o,selectable:a,passive:s,addClass:i,mouseover_handler:function(t){bubble(e,t)},mouseleave_handler:function(t){bubble(e,t)},click_handler:function(t){bubble(e,t)},mouseover_handler_1:function(t){bubble(e,t)},mouseleave_handler_1:function(t){bubble(e,t)},$$slots:c,$$scope:l}}class Card extends SvelteComponent{constructor(e){super(),init(this,e,instance$6,create_fragment$6,safe_not_equal,["disabled","active","selectable","passive","addClass"])}}function create_if_block_2(e){var t,n,r,o;return{c(){t=element("span"),n=text(e.volTxt),attr(t,"class","info-txt svelte-1cd8m9g")},m(e,r){insert(e,t,r),append(t,n),o=!0},p(e,t){o&&!e.volTxt||set_data(n,t.volTxt)},i(e){o||(add_render_callback(()=>{r||(r=create_bidirectional_transition(t,slide,{},!0)),r.run(1)}),o=!0)},o(e){r||(r=create_bidirectional_transition(t,slide,{},!1)),r.run(0),o=!1},d(e){e&&(detach(t),r&&r.end())}}}function create_default_slot_4(e){var t;return{c(){(t=element("span")).textContent="✗",set_style(t,"font-family","'Inter', sans-serif"),set_style(t,"font-size","1.2rem")},m(e,n){insert(e,t,n)},d(e){e&&detach(t)}}}function create_if_block$3(e){var t,n,r,o,a,s,i,c,l,u,d,f,p,m,_,h=normalizedName(e.soundfont),v=new Button({props:{outline:!0,$$slots:{default:[create_default_slot_3]},$$scope:{ctx:e}}});v.$on("click",e.octavePlus);var g=new Button({props:{outline:!0,spaced:!0,$$slots:{default:[create_default_slot_2]},$$scope:{ctx:e}}});function $(t){e.slidecontrol_value_binding.call(null,t),d=!0,add_flush_callback(()=>d=!1)}g.$on("click",e.octaveMinus);let b={min:-1,max:100,step:1,title:"Volume",customValueDisplay:{"-1":e.absoluteVolume?"Current":"Default",0:"Muted"}};void 0!==e.volume&&(b.value=e.volume);var y=new SlideControl({props:b});binding_callbacks.push(()=>bind(y,"value",$)),y.$on("change",e.setVolume);var S=new Button({props:{style:"transform: translateY(0.8rem)",outline:!0,spaced:!0,$$slots:{default:[create_default_slot_1]},$$scope:{ctx:e}}});S.$on("click",e.toggleAbsoluteVolume);var k=e.$showAdsr&&create_if_block_1(e);return{c(){t=element("div"),n=element("p"),r=text("Sound font: "),o=text(h),a=space(),s=element("div"),v.$$.fragment.c(),i=space(),g.$$.fragment.c(),c=space(),l=element("div"),u=element("div"),y.$$.fragment.c(),f=space(),S.$$.fragment.c(),p=space(),k&&k.c(),attr(n,"class","info-txt svelte-1cd8m9g"),set_style(s,"margin","0.6rem 0"),attr(s,"class","row svelte-1cd8m9g"),set_style(u,"flex-grow","1"),attr(l,"class","row svelte-1cd8m9g"),attr(t,"class","toolbar svelte-1cd8m9g")},m(e,d){insert(e,t,d),append(t,n),append(n,r),append(n,o),append(t,a),append(t,s),mount_component(v,s,null),append(s,i),mount_component(g,s,null),append(t,c),append(t,l),append(l,u),mount_component(y,u,null),append(l,f),mount_component(S,l,null),append(t,p),k&&k.m(t,null),_=!0},p(e,n){_&&!e.soundfont||h===(h=normalizedName(n.soundfont))||set_data(o,h);var r={};e.$$scope&&(r.$$scope={changed:e,ctx:n}),v.$set(r);var a={};e.$$scope&&(a.$$scope={changed:e,ctx:n}),g.$set(a);var s={};e.absoluteVolume&&(s.customValueDisplay={"-1":n.absoluteVolume?"Current":"Default",0:"Muted"}),!d&&e.volume&&(s.value=n.volume),y.$set(s);var i={};(e.$$scope||e.absoluteVolume)&&(i.$$scope={changed:e,ctx:n}),S.$set(i),n.$showAdsr?k?(k.p(e,n),transition_in(k,1)):((k=create_if_block_1(n)).c(),transition_in(k,1),k.m(t,null)):k&&(group_outros(),transition_out(k,1,()=>{k=null}),check_outros())},i(e){_||(transition_in(v.$$.fragment,e),transition_in(g.$$.fragment,e),transition_in(y.$$.fragment,e),transition_in(S.$$.fragment,e),transition_in(k),add_render_callback(()=>{m||(m=create_bidirectional_transition(t,slide,{},!0)),m.run(1)}),_=!0)},o(e){transition_out(v.$$.fragment,e),transition_out(g.$$.fragment,e),transition_out(y.$$.fragment,e),transition_out(S.$$.fragment,e),transition_out(k),m||(m=create_bidirectional_transition(t,slide,{},!1)),m.run(0),_=!1},d(e){e&&detach(t),destroy_component(v),destroy_component(g),destroy_component(y),destroy_component(S),k&&k.d(),e&&m&&m.end()}}}function create_default_slot_3(e){var t;return{c(){t=text("Octave +")},m(e,n){insert(e,t,n)},d(e){e&&detach(t)}}}function create_default_slot_2(e){var t;return{c(){t=text("Octave -")},m(e,n){insert(e,t,n)},d(e){e&&detach(t)}}}function create_default_slot_1(e){var t,n=e.absoluteVolume?"% of current":"Absolute";return{c(){t=text(n)},m(e,n){insert(e,t,n)},p(e,r){e.absoluteVolume&&n!==(n=r.absoluteVolume?"% of current":"Absolute")&&set_data(t,n)},d(e){e&&detach(t)}}}function create_if_block_1(e){var t,n,r,o,a,s,i,c;function l(n){e.slidecontrol0_value_binding.call(null,n),t=!0,add_flush_callback(()=>t=!1)}let u={min:-.01,max:1,step:.01,title:"Attack",customValueDisplay:{"-0.01":"Default",.005:"Default"}};void 0!==e.adsr[0]&&(u.value=e.adsr[0]);var d=new SlideControl({props:u});function f(t){e.slidecontrol1_value_binding.call(null,t),r=!0,add_flush_callback(()=>r=!1)}binding_callbacks.push(()=>bind(d,"value",l)),d.$on("change",e.setAdsr);let p={min:-.01,max:1,step:.01,title:"Delay",customValueDisplay:{"-0.01":"Default",.395:"Default"}};void 0!==e.adsr[1]&&(p.value=e.adsr[1]);var m=new SlideControl({props:p});function _(t){e.slidecontrol2_value_binding.call(null,t),a=!0,add_flush_callback(()=>a=!1)}binding_callbacks.push(()=>bind(m,"value",f)),m.$on("change",e.setAdsr);let h={min:-.01,max:1,step:.01,title:"Sustain",customValueDisplay:{"-0.01":"Default",.8:"Default"}};void 0!==e.adsr[2]&&(h.value=e.adsr[2]);var v=new SlideControl({props:h});function g(t){e.slidecontrol3_value_binding.call(null,t),i=!0,add_flush_callback(()=>i=!1)}binding_callbacks.push(()=>bind(v,"value",_)),v.$on("change",e.setAdsr);let $={min:-.01,max:1,step:.01,title:"Release",customValueDisplay:{"-0.01":"Default",1.2:"Default"}};void 0!==e.adsr[3]&&($.value=e.adsr[3]);var b=new SlideControl({props:$});return binding_callbacks.push(()=>bind(b,"value",g)),b.$on("change",e.setAdsr),{c(){d.$$.fragment.c(),n=space(),m.$$.fragment.c(),o=space(),v.$$.fragment.c(),s=space(),b.$$.fragment.c()},m(e,t){mount_component(d,e,t),insert(e,n,t),mount_component(m,e,t),insert(e,o,t),mount_component(v,e,t),insert(e,s,t),mount_component(b,e,t),c=!0},p(e,n){var o={};!t&&e.adsr&&(o.value=n.adsr[0]),d.$set(o);var s={};!r&&e.adsr&&(s.value=n.adsr[1]),m.$set(s);var c={};!a&&e.adsr&&(c.value=n.adsr[2]),v.$set(c);var l={};!i&&e.adsr&&(l.value=n.adsr[3]),b.$set(l)},i(e){c||(transition_in(d.$$.fragment,e),transition_in(m.$$.fragment,e),transition_in(v.$$.fragment,e),transition_in(b.$$.fragment,e),c=!0)},o(e){transition_out(d.$$.fragment,e),transition_out(m.$$.fragment,e),transition_out(v.$$.fragment,e),transition_out(b.$$.fragment,e),c=!1},d(e){destroy_component(d,e),e&&detach(n),destroy_component(m,e),e&&detach(o),destroy_component(v,e),e&&detach(s),destroy_component(b,e)}}}function create_default_slot(e){var t,n,r,o,a,s,i,c,l,u,d,f,p=normalizedName(e.name),m=e.volume>-1&&create_if_block_2(e),_=new Button({props:{style:"height: 1.6rem; width: 1.6rem; padding: 0; margin: 0.2rem; transform: translateY(0.15rem)",outline:!0,$$slots:{default:[create_default_slot_4]},$$scope:{ctx:e}}});_.$on("click",e.removeInstrument);var h=e.optionsVisible&&create_if_block$3(e);return{c(){t=element("div"),n=element("div"),r=element("h4"),o=text(p),a=space(),s=element("span"),i=text(e.octShift),c=space(),m&&m.c(),l=space(),_.$$.fragment.c(),u=space(),h&&h.c(),d=empty(),attr(r,"class","uppercase svelte-1cd8m9g"),attr(s,"class","info-txt svelte-1cd8m9g"),attr(n,"class","status svelte-1cd8m9g"),attr(t,"class","row svelte-1cd8m9g")},m(e,p){insert(e,t,p),append(t,n),append(n,r),append(r,o),append(n,a),append(n,s),append(s,i),append(n,c),m&&m.m(n,null),append(t,l),mount_component(_,t,null),insert(e,u,p),h&&h.m(e,p),insert(e,d,p),f=!0},p(e,t){f&&!e.name||p===(p=normalizedName(t.name))||set_data(o,p),f&&!e.octShift||set_data(i,t.octShift),t.volume>-1?m?(m.p(e,t),transition_in(m,1)):((m=create_if_block_2(t)).c(),transition_in(m,1),m.m(n,null)):m&&(group_outros(),transition_out(m,1,()=>{m=null}),check_outros());var r={};e.$$scope&&(r.$$scope={changed:e,ctx:t}),_.$set(r),t.optionsVisible?h?(h.p(e,t),transition_in(h,1)):((h=create_if_block$3(t)).c(),transition_in(h,1),h.m(d.parentNode,d)):h&&(group_outros(),transition_out(h,1,()=>{h=null}),check_outros())},i(e){f||(transition_in(m),transition_in(_.$$.fragment,e),transition_in(h),f=!0)},o(e){transition_out(m),transition_out(_.$$.fragment,e),transition_out(h),f=!1},d(e){e&&detach(t),m&&m.d(),destroy_component(_),e&&detach(u),h&&h.d(e),e&&detach(d)}}}function create_fragment$7(e){var t,n=new Card({props:{$$slots:{default:[create_default_slot]},$$scope:{ctx:e}}});return n.$on("mouseover",e.mouseover_handler),n.$on("mouseleave",e.mouseleave_handler),{c(){n.$$.fragment.c()},m(e,r){mount_component(n,e,r),t=!0},p(e,t){var r={};(e.$$scope||e.optionsVisible||e.$showAdsr||e.adsr||e.absoluteVolume||e.volume||e.soundfont||e.volTxt||e.octShift||e.name)&&(r.$$scope={changed:e,ctx:t}),n.$set(r)},i(e){t||(transition_in(n.$$.fragment,e),t=!0)},o(e){transition_out(n.$$.fragment,e),t=!1},d(e){destroy_component(n,e)}}}function normalizedName(e){return(e=e.replace(/_/g," ")).charAt(0).toUpperCase()+e.slice(1)}function clamp(e,t,n){return e<=t?t:e>=n?n:e}function instance$7(e,t,n){let r,o,a;subscribe(e,instrumentSets,e=>{n("$instrumentSets",r=e)}),subscribe(e,activeSet,e=>{n("$activeSet",o=e)}),subscribe(e,showAdsr,e=>{n("$showAdsr",a=e)});let s,i,{id:c,name:l,volume:u,octave:d,data:f,soundfont:p,adsr:m,absoluteVolume:_}=t,h=!1;return e.$set=(e=>{"id"in e&&n("id",c=e.id),"name"in e&&n("name",l=e.name),"volume"in e&&n("volume",u=e.volume),"octave"in e&&n("octave",d=e.octave),"data"in e&&n("data",f=e.data),"soundfont"in e&&n("soundfont",p=e.soundfont),"adsr"in e&&n("adsr",m=e.adsr),"absoluteVolume"in e&&n("absoluteVolume",_=e.absoluteVolume)}),e.$$.update=((e={octave:1,volume:1,absoluteVolume:1})=>{e.octave&&n("octShift",s=0==d?"No octave shift":d<0?`Octave ${d}`:`Octave +${d}`),(e.volume||e.absoluteVolume)&&n("volTxt",i=u>-1?u<1?"Muted":`Volume ${u}${_?"%":""}`:"Custom volume not set")}),{id:c,name:l,volume:u,octave:d,data:f,soundfont:p,adsr:m,absoluteVolume:_,optionsVisible:h,octavePlus:function(){let e=r,t=e[o].instruments.findIndex(e=>e.id===c),n=e[o].instruments[t].octave;e[o].instruments[t].octave=clamp(n+1,-3,3),instrumentSets.set(e)},octaveMinus:function(){let e=r,t=e[o].instruments.findIndex(e=>e.id===c),n=e[o].instruments[t].octave;e[o].instruments[t].octave=clamp(n-1,-3,3),instrumentSets.set(e)},removeInstrument:function(){let e=r;e[o].instruments=e[o].instruments.filter(e=>e.id!==c),instrumentSets.set(e)},setVolume:function(){let e=r,t=e[o].instruments.findIndex(e=>e.id===c);e[o].instruments[t].volume=u,instrumentSets.set(e)},toggleAbsoluteVolume:function(){let e=r,t=e[o].instruments.findIndex(e=>e.id===c);e[o].instruments[t].absoluteVolume=!e[o].instruments[t].absoluteVolume,instrumentSets.set(e)},setAdsr:function(){let e=r,t=e[o].instruments.findIndex(e=>e.id===c);e[o].instruments[t].adsr=m,instrumentSets.set(e)},octShift:s,volTxt:i,$showAdsr:a,slidecontrol_value_binding:function(e){n("volume",u=e)},slidecontrol0_value_binding:function(e){m[0]=e,n("adsr",m)},slidecontrol1_value_binding:function(e){m[1]=e,n("adsr",m)},slidecontrol2_value_binding:function(e){m[2]=e,n("adsr",m)},slidecontrol3_value_binding:function(e){m[3]=e,n("adsr",m)},mouseover_handler:function(){const e=h=!0;return n("optionsVisible",h),e},mouseleave_handler:function(){const e=h=!1;return n("optionsVisible",h),e}}}class InstrumentCard extends SvelteComponent{constructor(e){super(),init(this,e,instance$7,create_fragment$7,safe_not_equal,["id","name","volume","octave","data","soundfont","adsr","absoluteVolume"])}}function get_each_context$1(e,t,n){const r=Object.create(e);return r.instrument=t[n],r.i=n,r}function create_else_block$1(e){var t;return{c(){(t=element("p")).textContent="No instruments",attr(t,"class","error svelte-1yw2g1e")},m(e,n){insert(e,t,n)},d(e){e&&detach(t)}}}function create_each_block$1(e,t){var n,r,o=[t.instrument];let a={};for(var s=0;s<o.length;s+=1)a=assign(a,o[s]);var i=new InstrumentCard({props:a});return{key:e,first:null,c(){n=empty(),i.$$.fragment.c(),this.first=n},m(e,t){insert(e,n,t),mount_component(i,e,t),r=!0},p(e,t){var n=e.$instrumentSets||e.$activeSet?get_spread_update(o,[t.instrument]):{};i.$set(n)},i(e){r||(transition_in(i.$$.fragment,e),r=!0)},o(e){transition_out(i.$$.fragment,e),r=!1},d(e){e&&detach(n),destroy_component(i,e)}}}function create_fragment$8(e){var t,n,r,o,a,s,i=e.$instrumentSets[e.$activeSet].name,c=[],l=new Map,u=e.$instrumentSets[e.$activeSet].instruments;const d=e=>e.instrument.id;for(var f=0;f<u.length;f+=1){let t=get_each_context$1(e,u,f),n=d(t);l.set(n,c[f]=create_each_block$1(n,t))}var p=null;return u.length||(p=create_else_block$1()).c(),{c(){for(t=element("div"),n=element("h4"),r=text(i),o=space(),a=element("div"),f=0;f<c.length;f+=1)c[f].c();attr(n,"class","svelte-1yw2g1e"),attr(a,"class","list svelte-1yw2g1e"),set_style(t,"width","22rem")},m(e,i){for(insert(e,t,i),append(t,n),append(n,r),append(t,o),append(t,a),f=0;f<c.length;f+=1)c[f].m(a,null);p&&p.m(a,null),s=!0},p(e,t){s&&!e.$instrumentSets&&!e.$activeSet||i===(i=t.$instrumentSets[t.$activeSet].name)||set_data(r,i);const n=t.$instrumentSets[t.$activeSet].instruments;group_outros(),c=update_keyed_each(c,e,d,1,t,n,l,a,outro_and_destroy_block,create_each_block$1,null,get_each_context$1),check_outros(),n.length?p&&(p.d(1),p=null):p||((p=create_else_block$1()).c(),p.m(a,null))},i(e){if(!s){for(var t=0;t<u.length;t+=1)transition_in(c[t]);s=!0}},o(e){for(f=0;f<c.length;f+=1)transition_out(c[f]);s=!1},d(e){for(e&&detach(t),f=0;f<c.length;f+=1)c[f].d();p&&p.d()}}}function instance$8(e,t,n){let r,o;return subscribe(e,instrumentSets,e=>{n("$instrumentSets",r=e)}),subscribe(e,activeSet,e=>{n("$activeSet",o=e)}),{$instrumentSets:r,$activeSet:o}}class SetEditor extends SvelteComponent{constructor(e){super(),init(this,e,instance$8,create_fragment$8,safe_not_equal,[])}}function get_each_context_1(e,t,n){const r=Object.create(e);return r.i=t[n],r}function get_each_context$2(e,t,n){const r=Object.create(e);return r.set=t[n],r.each_value=t,r.i=n,r}function create_else_block$2(e){var t;return{c(){(t=element("p")).innerHTML="\n\t\t\t                🕳 No instrument sets.\n\t\t\t                <br>\n\t\t\t                This is an error.\n\t\t\t            "},m(e,n){insert(e,t,n)},d(e){e&&detach(t)}}}function create_if_block$4(e){var t,n=new Button({props:{outline:!0,$$slots:{default:[create_default_slot_1$1]},$$scope:{ctx:e}}});return n.$on("click",e.finishEditing),{c(){n.$$.fragment.c()},m(e,r){mount_component(n,e,r),t=!0},i(e){t||(transition_in(n.$$.fragment,e),t=!0)},o(e){transition_out(n.$$.fragment,e),t=!1},d(e){destroy_component(n,e)}}}function create_default_slot_1$1(e){var t;return{c(){t=text("Save")},m(e,n){insert(e,t,n)},d(e){e&&detach(t)}}}function create_each_block_1(e,t){var n,r,o,a,s,i,c=normalizedName$1(t.i.name),l=noop;return{key:e,first:null,c(){n=element("span"),r=text(c),o=space(),attr(n,"class","info-txt svelte-1n51zne"),this.first=n},m(e,t){insert(e,n,t),append(n,r),append(n,o),i=!0},p(e,t){i&&!e.$instrumentSets||c===(c=normalizedName$1(t.i.name))||set_data(r,c)},r(){s=n.getBoundingClientRect()},f(){fix_position(n),l(),add_transform(n,s)},a(){l(),l=create_animation(n,s,flip,{})},i(e){i||(add_render_callback(()=>{a||(a=create_bidirectional_transition(n,slide,{},!0)),a.run(1)}),i=!0)},o(e){a||(a=create_bidirectional_transition(n,slide,{},!1)),a.run(0),i=!1},d(e){e&&(detach(n),a&&a.end())}}}function create_default_slot$1(e){var t,n,r,o,a,s,i,c,l,u,d,f,p,m=[],_=new Map;function h(){e.input_input_handler.call(r,e)}var v=e.isEditing&&create_if_block$4(e),g=e.set.instruments;const $=e=>e.i.id;for(var b=0;b<g.length;b+=1){let t=get_each_context_1(e,g,b),n=$(t);_.set(n,m[b]=create_each_block_1(n,t))}var y=new KeyboardKey({props:{square:!0,key:e.i+1<10?e.i+1:0}});return{c(){for(t=element("div"),n=element("div"),r=element("input"),a=space(),s=element("div"),v&&v.c(),i=space(),b=0;b<m.length;b+=1)m[b].c();c=space(),l=element("div"),y.$$.fragment.c(),d=space(),attr(r,"type","text"),attr(r,"class",o="uppercase edit-field "+(e.isEditing?"":"label-field")+" svelte-1n51zne"),toggle_class(r,"act",e.$activeSet===e.i||e.isEditing),attr(n,"class","f-grow svelte-1n51zne"),attr(l,"class","f-shrink transform-key svelte-1n51zne"),attr(t,"class",u="fixed-card "+(e.set.instruments.length>0?"":"remove-btm-margin")+" svelte-1n51zne"),p=listen(r,"input",h)},m(o,u){for(insert(o,t,u),append(t,n),append(n,r),r.value=e.set.name,append(n,a),append(n,s),v&&v.m(s,null),append(n,i),b=0;b<m.length;b+=1)m[b].m(n,null);append(t,c),append(t,l),mount_component(y,l,null),insert(o,d,u),f=!0},p(a,i){e=i,a.$instrumentSets&&r.value!==e.set.name&&(r.value=e.set.name),f&&!a.isEditing||o===(o="uppercase edit-field "+(e.isEditing?"":"label-field")+" svelte-1n51zne")||attr(r,"class",o),(a.isEditing||a.$activeSet||a.isEditing)&&toggle_class(r,"act",e.$activeSet===e.i||e.isEditing),e.isEditing?v?transition_in(v,1):((v=create_if_block$4(e)).c(),transition_in(v,1),v.m(s,null)):v&&(group_outros(),transition_out(v,1,()=>{v=null}),check_outros());const c=e.set.instruments;group_outros();for(let e=0;e<m.length;e+=1)m[e].r();m=update_keyed_each(m,a,$,1,e,c,_,n,fix_and_outro_and_destroy_block,create_each_block_1,null,get_each_context_1);for(let e=0;e<m.length;e+=1)m[e].a();check_outros(),f&&!a.$instrumentSets||u===(u="fixed-card "+(e.set.instruments.length>0?"":"remove-btm-margin")+" svelte-1n51zne")||attr(t,"class",u)},i(e){if(!f){transition_in(v);for(var t=0;t<g.length;t+=1)transition_in(m[t]);transition_in(y.$$.fragment,e),f=!0}},o(e){for(transition_out(v),b=0;b<m.length;b+=1)transition_out(m[b]);transition_out(y.$$.fragment,e),f=!1},d(e){for(e&&detach(t),v&&v.d(),b=0;b<m.length;b+=1)m[b].d();destroy_component(y),e&&detach(d),p()}}}function create_each_block$2(e){var t;var n=new Card({props:{disabled:e.set.instruments.length<1,passive:!1,active:e.$activeSet===e.i,$$slots:{default:[create_default_slot$1]},$$scope:{ctx:e}}});return n.$on("click",function(){return e.click_handler(e)}),{c(){n.$$.fragment.c()},m(e,r){mount_component(n,e,r),t=!0},p(t,r){e=r;var o={};t.$instrumentSets&&(o.disabled=e.set.instruments.length<1),t.$activeSet&&(o.active=e.$activeSet===e.i),(t.$$scope||t.$instrumentSets||t.isEditing||t.$activeSet)&&(o.$$scope={changed:t,ctx:e}),n.$set(o)},i(e){t||(transition_in(n.$$.fragment,e),t=!0)},o(e){transition_out(n.$$.fragment,e),t=!1},d(e){destroy_component(n,e)}}}function create_fragment$9(e){for(var t,n,r,o,a,s=e.$instrumentSets,i=[],c=0;c<s.length;c+=1)i[c]=create_each_block$2(get_each_context$2(e,s,c));const l=e=>transition_out(i[e],1,()=>{i[e]=null});var u=null;return s.length||(u=create_else_block$2()).c(),{c(){t=element("div"),(n=element("h4")).textContent="Instrument sets",r=space(),o=element("div");for(var e=0;e<i.length;e+=1)i[e].c();set_style(n,"font-weight","400"),attr(n,"class","svelte-1n51zne"),attr(o,"class","list svelte-1n51zne"),attr(t,"class","container svelte-1n51zne")},m(e,s){insert(e,t,s),append(t,n),append(t,r),append(t,o);for(var c=0;c<i.length;c+=1)i[c].m(o,null);u&&u.m(o,null),a=!0},p(e,t){if(e.$instrumentSets||e.$activeSet||e.normalizedName||e.isEditing){s=t.$instrumentSets;for(var n=0;n<s.length;n+=1){const r=get_each_context$2(t,s,n);i[n]?(i[n].p(e,r),transition_in(i[n],1)):(i[n]=create_each_block$2(r),i[n].c(),transition_in(i[n],1),i[n].m(o,null))}for(group_outros(),n=s.length;n<i.length;n+=1)l(n);check_outros()}s.length?u&&(u.d(1),u=null):u||((u=create_else_block$2()).c(),u.m(o,null))},i(e){if(!a){for(var t=0;t<s.length;t+=1)transition_in(i[t]);a=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)transition_out(i[e]);a=!1},d(e){e&&detach(t),destroy_each(i,e),u&&u.d()}}}function normalizedName$1(e){return(e=e.replace(/_/g," ")).charAt(0).toUpperCase()+e.slice(1)}function instance$9(e,t,n){let r,o;subscribe(e,activeSet,e=>{n("$activeSet",r=e)}),subscribe(e,instrumentSets,e=>{n("$instrumentSets",o=e)});let a=!1;return{isEditing:a,finishEditing:function(){n("isEditing",a=!1)},$activeSet:r,$instrumentSets:o,input_input_handler:function({set:e,each_value:t,i:n}){t[n].name=this.value},click_handler:function({i:e}){activeSet.set(e)}}}class SetList extends SvelteComponent{constructor(e){super(),init(this,e,instance$9,create_fragment$9,safe_not_equal,[])}}function get_each_context$3(e,t,n){const r=Object.create(e);return r.item=t[n],r}function create_default_slot_2$1(e){var t,n,r=normalizeInstrumentName(e.item);return{c(){t=text(r),n=space()},m(e,r){insert(e,t,r),insert(e,n,r)},p(e,n){e.filteredList&&r!==(r=normalizeInstrumentName(n.item))&&set_data(t,r)},d(e){e&&(detach(t),detach(n))}}}function create_each_block$3(e,t){var n,r;var o=new Button({props:{style:"width: 12rem; height: 2rem; margin-bottom: 0.4rem; text-align: left;",$$slots:{default:[create_default_slot_2$1]},$$scope:{ctx:t}}});return o.$on("click",function(...e){return t.click_handler(t,...e)}),{key:e,first:null,c(){n=empty(),o.$$.fragment.c(),this.first=n},m(e,t){insert(e,n,t),mount_component(o,e,t),r=!0},p(e,n){t=n;var r={};(e.$$scope||e.filteredList)&&(r.$$scope={changed:e,ctx:t}),o.$set(r)},i(e){r||(transition_in(o.$$.fragment,e),r=!0)},o(e){transition_out(o.$$.fragment,e),r=!1},d(e){e&&detach(n),destroy_component(o,e)}}}function create_default_slot_1$2(e){var t;return{c(){t=text(e.$currentSoundFont)},m(e,n){insert(e,t,n)},p(e,n){e.$currentSoundFont&&set_data(t,n.$currentSoundFont)},d(e){e&&detach(t)}}}function create_default_slot$2(e){var t,n=e.$showAdsr?"✓":"✗";return{c(){t=text(n)},m(e,n){insert(e,t,n)},p(e,r){e.$showAdsr&&n!==(n=r.$showAdsr?"✓":"✗")&&set_data(t,n)},d(e){e&&detach(t)}}}function create_fragment$a(e){var t,n,r,o,a,s,i,c,l,u,d,f,p,m,_,h,v,g,$=[],b=new Map,y=e.filteredList;const S=e=>e.item;for(var k=0;k<y.length;k+=1){let t=get_each_context$3(e,y,k),n=S(t);b.set(n,$[k]=create_each_block$3(n,t))}var w=new Button({props:{$$slots:{default:[create_default_slot_1$2]},$$scope:{ctx:e}}});w.$on("click",e.switchSf);var x=new Button({props:{style:"font-family: 'Inter', sans-serif;",$$slots:{default:[create_default_slot$2]},$$scope:{ctx:e}}});return x.$on("click",e.switchAdsrOpt),{c(){for(t=element("div"),(n=element("h4")).textContent="Instruments",r=space(),o=element("div"),a=element("input"),s=space(),i=element("div"),k=0;k<$.length;k+=1)$[k].c();c=space(),l=element("div"),u=element("div"),(d=element("span")).textContent="Sound font",f=space(),w.$$.fragment.c(),p=space(),m=element("div"),(_=element("span")).textContent="Show ADSR controls",h=space(),x.$$.fragment.c(),attr(n,"class","svelte-1cb2r0y"),attr(a,"class","search-box svelte-1cb2r0y"),attr(a,"placeholder","Search..."),attr(a,"type","search"),attr(i,"class","scrollList svelte-1cb2r0y"),attr(o,"class","selector"),attr(d,"class","svelte-1cb2r0y"),attr(u,"class","row svelte-1cb2r0y"),set_style(_,"margin-top","0.8rem"),attr(_,"class","svelte-1cb2r0y"),attr(m,"class","row svelte-1cb2r0y"),attr(l,"class","mini-column svelte-1cb2r0y"),attr(t,"class","column svelte-1cb2r0y"),g=[listen(a,"input",e.input_input_handler),listen(a,"focus",setFocused),listen(a,"blur",setUnfocused)]},m(g,b){for(insert(g,t,b),append(t,n),append(t,r),append(t,o),append(o,a),a.value=e.filterString,append(o,s),append(o,i),k=0;k<$.length;k+=1)$[k].m(i,null);append(t,c),append(t,l),append(l,u),append(u,d),append(u,f),mount_component(w,u,null),append(l,p),append(l,m),append(m,_),append(m,h),mount_component(x,m,null),v=!0},p(e,t){e.filterString&&(a.value=t.filterString);const n=t.filteredList;group_outros(),$=update_keyed_each($,e,S,1,t,n,b,i,outro_and_destroy_block,create_each_block$3,null,get_each_context$3),check_outros();var r={};(e.$$scope||e.$currentSoundFont)&&(r.$$scope={changed:e,ctx:t}),w.$set(r);var o={};(e.$$scope||e.$showAdsr)&&(o.$$scope={changed:e,ctx:t}),x.$set(o)},i(e){if(!v){for(var t=0;t<y.length;t+=1)transition_in($[t]);transition_in(w.$$.fragment,e),transition_in(x.$$.fragment,e),v=!0}},o(e){for(k=0;k<$.length;k+=1)transition_out($[k]);transition_out(w.$$.fragment,e),transition_out(x.$$.fragment,e),v=!1},d(e){for(e&&detach(t),k=0;k<$.length;k+=1)$[k].d();destroy_component(w),destroy_component(x),run_all(g)}}}function normalizeInstrumentName(e){return(e=e.replace(/_/g," ")).charAt(0).toUpperCase()+e.slice(1)}function randId(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10)}function setFocused(){isFocused.set(!0)}function setUnfocused(){isFocused.set(!1)}function instance$a(e,t,n){let r,o,a,s,i;subscribe(e,currentSoundFont,e=>{n("$currentSoundFont",r=e)}),subscribe(e,instrumentSets,e=>{n("$instrumentSets",o=e)}),subscribe(e,activeSet,e=>{n("$activeSet",a=e)}),subscribe(e,showAdsr,e=>{n("$showAdsr",s=e)});let c,l=[],u="";async function d(){let e=await fetch(`https://gleitz.github.io/midi-js-soundfonts/${r}/names.json`);n("availInstruments",l=await e.json()),i=l[0]}function f(e){null!=e&&(i=e,function(){if(null==i)return;let e=Soundfont.instrument(ac,i,{soundfont:r}),t={id:randId(),name:i,volume:-1,octave:0,absoluteVolume:!0,data:e,soundfont:r,adsr:[-.01,-.01,-.01,-.01]},n=o;n[a].instruments.push(t),instrumentSets.set(n)}())}return d(),e.$$.update=((e={filterString:1,availInstruments:1})=>{(e.filterString||e.availInstruments)&&n("filteredList",c=""===u.trim()?l:l.filter(e=>-1!==e.toLowerCase().indexOf(u.toLowerCase())))}),{filterString:u,addPickedInstrument:f,switchSf:function(){let e=r;e==soundFont.fluid&&currentSoundFont.set(soundFont.mk),e==soundFont.mk&&currentSoundFont.set(soundFont.fatboy),e==soundFont.fatboy&&currentSoundFont.set(soundFont.fluid),d()},switchAdsrOpt:function(){let e=s;showAdsr.set(!e)},filteredList:c,$currentSoundFont:r,$showAdsr:s,input_input_handler:function(){u=this.value,n("filterString",u)},click_handler:function({item:e},t){return f(e)}}}class InstrumentList extends SvelteComponent{constructor(e){super(),init(this,e,instance$a,create_fragment$a,safe_not_equal,[])}}function b64ToUint6(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0}function decode(e,t){for(var n,r,o=e.replace(/[^A-Za-z0-9\+\/]/g,""),a=o.length,s=t?Math.ceil((3*a+1>>2)/t)*t:3*a+1>>2,i=new Uint8Array(s),c=0,l=0,u=0;u<a;u++)if(r=3&u,c|=b64ToUint6(o.charCodeAt(u))<<18-6*r,3===r||a-u==1){for(n=0;n<3&&l<s;n++,l++)i[l]=c>>>(16>>>n&24)&255;c=0}return i}var base64={decode:decode},fetch$1=function(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;t&&(o.responseType=t),o.open("GET",e),o.onload=function(){200===o.status?n(o.response):r(Error(o.statusText))},o.onerror=function(){r(Error("Network Error"))},o.send()})},lib=createCommonjsModule(function(e){function t(e){return function(t){return"string"==typeof t&&e.test(t)}}function n(e,t){return"string"==typeof e?e+t:"function"==typeof e?e(t):t}function r(e,t,n,r){var v=t instanceof ArrayBuffer?o:a(t)?s:function(e){return e&&"function"==typeof e.then}(t)?i:c(t)?l:function(e){return e&&"object"==typeof e}(t)?u:d(t)?f:p(t)?m:_(t)?h:null;return v?v(e,t,n||{}):r?Promise.resolve(r):Promise.reject("Source not valid ("+t+")")}function o(e,t,n){return new Promise(function(n,r){e.decodeAudioData(t,function(e){n(e)},function(){r("Can't decode audio data ("+t.slice(0,30)+"...)")})})}r.fetch=fetch$1;var a=t(/\.(mp3|wav|ogg)(\?.*)?$/i);function s(e,t,o){var a=n(o.from,t);return r(e,r.fetch(a,"arraybuffer"),o)}function i(e,t,n){return t.then(function(t){return r(e,t,n)})}var c=Array.isArray;function l(e,t,n){return Promise.all(t.map(function(t){return r(e,t,n,t)}))}function u(e,t,n){var o={},a=Object.keys(t).map(function(a){if(n.only&&-1===n.only.indexOf(a))return null;var s=t[a];return r(e,s,n,s).then(function(e){o[a]=e})});return Promise.all(a).then(function(){return o})}var d=t(/\.json(\?.*)?$/i);function f(e,t,o){var a=n(o.from,t);return r(e,r.fetch(a,"text").then(JSON.parse),o)}var p=t(/^data:audio/);function m(e,t,n){var o=t.indexOf(",");return r(e,base64.decode(t.slice(o+1)).buffer,n)}var _=t(/\.js(\?.*)?$/i);function h(e,t,o){var a=n(o.from,t);return r(e,r.fetch(a,"text").then(v),o)}function v(e){var t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");t=e.indexOf("=",t)+2;var n=e.lastIndexOf(",");return JSON.parse(e.slice(t,n)+"}")}e.exports&&(e.exports=r),"undefined"!=typeof window&&(window.loadAudio=r)}),adsr=ADSR;function ADSR(e){var t=e.createGain(),n=t._voltage=getVoltage(e),r=scale(n),o=scale(n),a=scale(n);return t._startAmount=scale(o),t._endAmount=scale(a),t._multiplier=scale(r),t._multiplier.connect(t),t._startAmount.connect(t),t._endAmount.connect(t),t.value=r.gain,t.startValue=o.gain,t.endValue=a.gain,t.startValue.value=0,t.endValue.value=0,Object.defineProperties(t,props),t}var props={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,r=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var o=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),r.cancelScheduledValues(e),r.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(o,this._decayFrom,getTimeConstant(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var r=this._multiplier.gain,o=this._startAmount.gain,a=this._endAmount.gain;r.cancelScheduledValues(e),o.cancelScheduledValues(e),a.cancelScheduledValues(e);var s=getTimeConstant(this.release);if(this.attack&&e<this._decayFrom){var i=getValue(0,1,this._startedAt,this._decayFrom,e);r.linearRampToValueAtTime(i,e),o.linearRampToValueAtTime(1-i,e),o.setTargetAtTime(0,e,s)}a.setTargetAtTime(1,e,s),r.setTargetAtTime(0,e,s)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},flat=new Float32Array([1,1]);function getVoltage(e){var t=e.createBufferSource(),n=e.createBuffer(1,2,e.sampleRate);return n.getChannelData(0).set(flat),t.buffer=n,t.loop=!0,t}function scale(e){var t=e.context.createGain();return e.connect(t),t}function getTimeConstant(e){return Math.log(e+1)/Math.log(100)}function getValue(e,t,n,r,o){var a=e+(o-n)/(r-n)*(t-e);return a<=e&&(a=e),a>=t&&(a=t),a}var EMPTY={},DEFAULTS={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function SamplePlayer(e,t,n){var r=!1,o=0,a={},s=e.createGain();s.gain.value=1;var i=Object.assign({},DEFAULTS,n),c={context:e,out:s,opts:i};return t instanceof AudioBuffer?c.buffer=t:c.buffers=t,c.start=function(t,n,s){if(c.buffer&&null!==t)return c.start(null,t,n);var i=t?c.buffers[t]:c.buffer;if(i){if(r){var u=s||EMPTY;n=Math.max(e.currentTime,n||0),c.emit("start",n,t,u);var d=l(t,i,u);return d.id=function(t,n){return n.id=o++,a[n.id]=n,n.source.onended=function(){var t=e.currentTime;n.source.disconnect(),n.env.disconnect(),n.disconnect(),c.emit("ended",t,n.id,n)},n.id}(0,d),d.env.start(n),d.source.start(n),c.emit("started",n,d.id,d),u.duration&&d.stop(n+u.duration),d}console.warn("SamplePlayer not connected to any node.")}else console.warn("Buffer "+t+" not found.")},c.play=function(e,t,n){return c.start(e,t,n)},c.stop=function(e,t){var n;return(t=t||Object.keys(a)).map(function(t){return(n=a[t])?(n.stop(e),n.id):null})},c.connect=function(e){return r=!0,s.connect(e),c},c.emit=function(e,t,n,r){c.onevent&&c.onevent(e,t,n,r);var o=c["on"+e];o&&o(t,n,r)},c;function l(t,n,r){var o=e.createGain();return o.gain.value=0,o.connect(s),o.env=envelope(e,r,i),o.env.connect(o.gain),o.source=e.createBufferSource(),o.source.buffer=n,o.source.connect(o),o.source.loop=r.loop||i.loop,o.source.playbackRate.value=centsToRate(r.cents||i.cents),o.source.loopStart=r.loopStart||i.loopStart,o.source.loopEnd=r.loopEnd||i.loopEnd,o.stop=function(n){var r=n||e.currentTime;c.emit("stop",r,t);var a=o.env.stop(r);o.source.stop(a)},o}}function isNum(e){return"number"==typeof e}var PARAMS=["attack","decay","sustain","release"];function envelope(e,t,n){var r=adsr(e),o=t.adsr||n.adsr;return PARAMS.forEach(function(e,a){r[e]=o?o[a]:t[e]||n[e]}),r.value.value=isNum(t.gain)?t.gain:isNum(n.gain)?n.gain:1,r}function centsToRate(e){return e?Math.pow(2,e/1200):1}var player=SamplePlayer,events=function(e){return e.on=function(t,n){if(1===arguments.length&&"function"==typeof t)return e.on("event",t);var r="on"+t,o=e[r];return e[r]=o?chain(o,n):n,e},e};function chain(e,t){return function(n,r,o,a){e(n,r,o,a),t(n,r,o,a)}}var REGEX=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;function regex(){return REGEX}var SEMITONES=[0,2,4,5,7,9,11];function parse(e,t,n){if("string"!=typeof e)return null;var r=REGEX.exec(e);if(!r||!t&&r[4])return null;var o={letter:r[1].toUpperCase(),acc:r[2].replace(/x/g,"##")};return o.pc=o.letter+o.acc,o.step=(o.letter.charCodeAt(0)+3)%7,o.alt="b"===o.acc[0]?-o.acc.length:o.acc.length,o.chroma=SEMITONES[o.step]+o.alt,r[3]&&(o.oct=+r[3],o.midi=o.chroma+12*(o.oct+1),o.freq=midiToFreq(o.midi,n)),t&&(o.tonicOf=r[4]),o}function midiToFreq(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var parser={parse:parse,regex:regex,midiToFreq:midiToFreq},FNS=["letter","acc","pc","step","alt","chroma","oct","midi","freq"];FNS.forEach(function(e){parser[e]=function(t){var n=parse(t);return n&&void 0!==n[e]?n[e]:null}});var noteParser=parser,isMidi=function(e){return null!==e&&e!==[]&&e>=0&&e<129},toMidi=function(e){return isMidi(e)?+e:noteParser.midi(e)},notes=function(e){if(e.buffers){var t=e.opts.map,n="function"==typeof t?t:toMidi,r=function(e){return e?n(e)||e:null};e.buffers=mapBuffers(e.buffers,r);var o=e.start;e.start=function(e,t,n){var a=r(e),s=a%1;return s&&(a=Math.floor(a),n=Object.assign(n||{},{cents:Math.floor(100*s)})),o(a,t,n)}}return e};function mapBuffers(e,t){return Object.keys(e).reduce(function(n,r){return n[t(r)]=e[r],n},{})}var isArr=Array.isArray,isObj=function(e){return e&&"object"==typeof e},OPTS={},scheduler=function(e){return e.schedule=function(t,n){var r,o,a,s,i=e.context.currentTime,c=t<i?i:t;return e.emit("schedule",c,n),n.map(function(t){return t?(isArr(t)?(r=t[0],o=t[1]):(r=t.time,o=t),isObj(o)?(a=o.name||o.key||o.note||o.midi||null,s=o):(a=o,s=OPTS),e.start(a,c+(r||0),s)):null})},e},index_min=createCommonjsModule(function(e,t){e.exports=function e(t,n,r){function o(s,i){if(!n[s]){if(!t[s]){var c="function"==typeof commonjsRequire&&commonjsRequire;if(!i&&c)return c(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return o(n||e)},u,u.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof commonjsRequire&&commonjsRequire,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return new function(e){if(this._event=e,this._data=e.data,this.receivedTime=e.receivedTime,this._data&&this._data.length<2)console.warn("Illegal MIDI message of length",this._data.length);else switch(this._messageCode=240&e.data[0],this.channel=15&e.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 144:this.messageType="noteon",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 160:this.messageType="keypressure",this.key=127&e.data[1],this.pressure=127&e.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&e.data[1],this.controllerValue=127&e.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=e.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&e.data[1];break;case 224:this.messageType="pitchbendchange";var t=127&e.data[2],n=127&e.data[1];this.pitchBend=(t<<8)+n}}(e)},t.exports=n.default},{}]},{},[1])(1)});unwrapExports(index_min);var midi=function(e){return e.listenToMidi=function(t,n){var r={},o=n||{},a=o.gain||function(e){return e/127};return t.onmidimessage=function(t){var n=t.messageType?t:index_min(t);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!o.channel||n.channel===o.channel)switch(n.messageType){case"noteon":r[n.key]=e.play(n.key,0,{gain:a(n.velocity)});break;case"noteoff":r[n.key]&&(r[n.key].stop(),delete r[n.key])}},e},e},lib$1=createCommonjsModule(function(e){function t(e,t,n){return midi(scheduler(notes(events(player(e,t,n)))))}e.exports&&(e.exports=t),"undefined"!=typeof window&&(window.SamplePlayer=t)});function fillStr(e,t){return Array(t+1).join(e)}function isNum$1(e){return"number"==typeof e}function isStr(e){return"string"==typeof e}function isDef(e){return void 0!==e}function midiToFreq$1(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var REGEX$1=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;function regex$1(){return REGEX$1}var SEMITONES$1=[0,2,4,5,7,9,11];function parse$1(e,t,n){if("string"!=typeof e)return null;var r=REGEX$1.exec(e);if(!r||!t&&r[4])return null;var o={letter:r[1].toUpperCase(),acc:r[2].replace(/x/g,"##")};o.pc=o.letter+o.acc,o.step=(o.letter.charCodeAt(0)+3)%7,o.alt="b"===o.acc[0]?-o.acc.length:o.acc.length;var a=SEMITONES$1[o.step]+o.alt;return o.chroma=a<0?12+a:a%12,r[3]&&(o.oct=+r[3],o.midi=a+12*(o.oct+1),o.freq=midiToFreq$1(o.midi,n)),t&&(o.tonicOf=r[4]),o}var LETTERS="CDEFGAB";function accStr(e){return isNum$1(e)?e<0?fillStr("b",-e):fillStr("#",e):""}function octStr(e){return isNum$1(e)?""+e:""}function build(e,t,n){return null==e?null:e.step?build(e.step,e.alt,e.oct):e<0||e>6?null:LETTERS.charAt(e)+accStr(t)+octStr(n)}function midi$1(e){if((isNum$1(e)||isStr(e))&&e>=0&&e<128)return+e;var t=parse$1(e);return t&&isDef(t.midi)?t.midi:null}function freq(e,t){var n=midi$1(e);return null===n?null:midiToFreq$1(n,t)}function letter(e){return(parse$1(e)||{}).letter}function acc(e){return(parse$1(e)||{}).acc}function pc(e){return(parse$1(e)||{}).pc}function step(e){return(parse$1(e)||{}).step}function alt(e){return(parse$1(e)||{}).alt}function chroma(e){return(parse$1(e)||{}).chroma}function oct(e){return(parse$1(e)||{}).oct}var noteParser$1=Object.freeze({regex:regex$1,parse:parse$1,build:build,midi:midi$1,freq:freq,letter:letter,acc:acc,pc:pc,step:step,alt:alt,chroma:chroma,oct:oct});function Soundfont$1(e,t){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof Soundfont$1))return new Soundfont$1(e);this.nameToUrl=t||Soundfont$1.nameToUrl,this.ctx=e,this.instruments={},this.promises=[]}function loadBuffers(e,t,n){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),Soundfont$1.instrument(e,t,n).then(function(e){return e.buffers})}function oscillatorPlayer(e,t){return t=t||{},function(n,r,o,a){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var s=n>0&&n<129?+n:noteParser$1.midi(n),i=s?noteParser$1.midiToFreq(s,440):null;if(i){o=o||.2;var c=(a=a||{}).destination||t.destination||e.destination,l=a.vcoType||t.vcoType||"sine",u=a.gain||t.gain||.4,d=e.createOscillator();d.type=l,d.frequency.value=i;var f=e.createGain();return f.gain.value=u,d.connect(f),f.connect(c),d.start(r),o>0&&d.stop(r+o),d}}}Soundfont$1.prototype.onready=function(e){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(e)},Soundfont$1.prototype.instrument=function(e,t){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((e=e||"default")in this.instruments)return this.instruments[e];var r={name:e,play:oscillatorPlayer(n,t)};if(this.instruments[e]=r,"default"!==e){var o=Soundfont$1.instrument(n,e,t).then(function(e){return r.play=e.play,r});this.promises.push(o),r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),o.then(e)}}else r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),e()};return r},Soundfont$1.loadBuffers=loadBuffers,Soundfont$1.noteToMidi=noteParser$1.midi;var legacy=Soundfont$1,lib$2=createCommonjsModule(function(e){function t(e){return/\.js(\?.*)?$/i.test(e)}function n(e,t,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(t="FluidR3_GM"===t?t:"MusyngKite")+"/"+e+"-"+(n="ogg"===n?n:"mp3")+".js"}legacy.instrument=function e(r,o,a){if(1===arguments.length)return function(t,n){return e(r,t,n)};var s=a||{},i=s.isSoundfontURL||t,c=s.nameToUrl||n,l=i(o)?o:c(o,s.soundfont,s.format);return lib(r,l,{only:s.only||s.notes}).then(function(e){var t=lib$1(r,e,s).connect(s.destination?s.destination:r.destination);return t.url=l,t.name=o,t})},legacy.nameToUrl=n,e.exports&&(e.exports=legacy),"undefined"!=typeof window&&(window.Soundfont=legacy)});const{window:window_1}=globals;function create_left_slot(e){var t;return{c(){(t=element("h3")).textContent="Piano",attr(t,"slot","left"),attr(t,"class","svelte-14ara1v")},m(e,n){insert(e,t,n)},d(e){e&&detach(t)}}}function create_default_slot_2$2(e){var t;return{c(){t=text("Stop all sounds")},m(e,n){insert(e,t,n)},d(e){e&&detach(t)}}}function create_default_slot_1$3(e){var t,n;return{c(){t=text(e.themeName),n=text(" theme")},m(e,r){insert(e,t,r),insert(e,n,r)},p(e,n){e.themeName&&set_data(t,n.themeName)},d(e){e&&(detach(t),detach(n))}}}function create_default_slot$3(e){var t,n,r,o=new Button({props:{outline:!0,$$slots:{default:[create_default_slot_2$2]},$$scope:{ctx:e}}});o.$on("click",e.stopAllSounds);var a=new Button({props:{spaced:!0,outline:!0,$$slots:{default:[create_default_slot_1$3]},$$scope:{ctx:e}}});return a.$on("click",e.switchDark),{c(){t=space(),o.$$.fragment.c(),n=space(),a.$$.fragment.c()},m(e,s){insert(e,t,s),mount_component(o,e,s),insert(e,n,s),mount_component(a,e,s),r=!0},p(e,t){var n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),o.$set(n);var r={};(e.$$scope||e.themeName)&&(r.$$scope={changed:e,ctx:t}),a.$set(r)},i(e){r||(transition_in(o.$$.fragment,e),transition_in(a.$$.fragment,e),r=!0)},o(e){transition_out(o.$$.fragment,e),transition_out(a.$$.fragment,e),r=!1},d(e){e&&detach(t),destroy_component(o,e),e&&detach(n),destroy_component(a,e)}}}function create_fragment$b(e){var t,n,r,o,a,s,i,c,l,u=new TitleBar({props:{$$slots:{default:[create_default_slot$3],left:[create_left_slot]},$$scope:{ctx:e}}}),d=new Controls({}),f=new PianoGrid({}),p=new InstrumentList({}),m=new SetEditor({}),_=new SetList({});return{c(){t=element("div"),u.$$.fragment.c(),n=space(),d.$$.fragment.c(),r=space(),f.$$.fragment.c(),o=space(),a=element("div"),p.$$.fragment.c(),s=space(),m.$$.fragment.c(),i=space(),_.$$.fragment.c(),attr(a,"class","split svelte-14ara1v"),attr(t,"class","container"),l=[listen(window_1,"keydown",e.handleKeyDown),listen(window_1,"keyup",e.handleKeyUp)]},m(e,l){insert(e,t,l),mount_component(u,t,null),append(t,n),mount_component(d,t,null),append(t,r),mount_component(f,t,null),append(t,o),append(t,a),mount_component(p,a,null),append(a,s),mount_component(m,a,null),append(a,i),mount_component(_,a,null),c=!0},p(e,t){var n={};(e.$$scope||e.themeName)&&(n.$$scope={changed:e,ctx:t}),u.$set(n)},i(e){c||(transition_in(u.$$.fragment,e),transition_in(d.$$.fragment,e),transition_in(f.$$.fragment,e),transition_in(p.$$.fragment,e),transition_in(m.$$.fragment,e),transition_in(_.$$.fragment,e),c=!0)},o(e){transition_out(u.$$.fragment,e),transition_out(d.$$.fragment,e),transition_out(f.$$.fragment,e),transition_out(p.$$.fragment,e),transition_out(m.$$.fragment,e),transition_out(_.$$.fragment,e),c=!1},d(e){e&&detach(t),destroy_component(u),destroy_component(d),destroy_component(f),destroy_component(p),destroy_component(m),destroy_component(_),run_all(l)}}}function clamp$1(e,t,n){return e<=t?t:e>=n?n:e}function instance$b(e,t,n){let r,o,a,s,i,c,l;subscribe(e,instrumentSets,e=>{n("$instrumentSets",r=e)}),subscribe(e,activeSet,e=>{n("$activeSet",o=e)}),subscribe(e,isFocused,e=>{n("$isFocused",a=e)}),subscribe(e,keysPressed,e=>{n("$keysPressed",s=e)}),subscribe(e,keysDown,e=>{n("$keysDown",i=e)}),subscribe(e,volume,e=>{n("$volume",c=e)}),subscribe(e,octaveShift,e=>{n("$octaveShift",l=e)}),instrumentSets.useLocalStorage(),showAdsr.useLocalStorage(),currentSoundFont.useLocalStorage(),activeSet.useLocalStorage(),volume.useLocalStorage(),octaveShift.useLocalStorage();let u,d=0;function f(){if(!(r[o].instruments.length<1)){for(let e of r[o].instruments)console.log(e),e.data.then(e=>{e.stop()});for(let e in keyCodes)document.querySelector("#"+keyCodes[e]).classList.remove("piano-key-highlight")}}function p(){0===d&&window.matchMedia("(prefers-color-scheme: dark)").matches||2===d?document.querySelector("html").className="dark":document.querySelector("html").className=""}return p(),e.$$.update=((e={theme:1})=>{e.theme&&n("themeName",u=0===d?"Auto":1===d?"Light":"Dark")}),{stopAllSounds:f,switchDark:function(){n("theme",++d),3===d&&n("theme",d=0),p()},handleKeyDown:function(e){if(a)return;let t=e.keyCode;if(!(r[o].instruments.length<1)&&null!=keyCodes[t]&&null!=keyNotes[t]&&null!==s[t]&&!0!==i[t]){document.querySelector("#"+keyCodes[t]).classList.add("piano-key-highlight"),i[t]=!0,keysDown.set(i);for(let e of r[o].instruments){let n=e.volume>-1?e.absoluteVolume?c*(e.volume/100)/100:e.volume/100:c/100,r=clamp$1(l+e.octave,-3,3);e.data.then(o=>{let a=e.adsr;a[0]<0&&(a[0]=defaultAdsr[0]),a[1]<0&&(a[1]=defaultAdsr[1]),a[2]<0&&(a[2]=defaultAdsr[2]),a[3]<0&&(a[3]=defaultAdsr[3]);let i=(parseInt(keyNotes[t])+12*r).toString(),c=o.play(i,ac.currentTime,{loop:!0,adsr:a,gain:n});if(-1===s[t].indexOf(c)){let e=s[t];s[t]=[...e,c],keysPressed.set(s)}})}}},handleKeyUp:function(e){if(a)return;let t=e.keyCode;if(t>=48&&t<=58){f();let e=t-49;48==t&&(e=9),activeSet.set(e)}if(16!==t)if(17!==t)if(37!==t){if(40===t)return c>=10&&volume.set(c-10),void(c-10<0&&volume.set(0));if(39!==t){if(38===t)return c<=90&&volume.set(c+10),void(c+10>100&&volume.set(100));if(!(r[o].instruments.length<1)&&null!=keyCodes[t]&&null!=keyNotes[t]&&null!==s[t]&&!1!==i[t]){for(var n of(document.querySelector("#"+keyCodes[t]).classList.remove("piano-key-highlight"),i[t]=!1,keysDown.set(i),s[t]))try{n.stop()}catch(e){console.error("Errored stop, stopping all."),console.error("Error: ",e.message),f()}s[t]=[],keysPressed.set(s)}}else c<99&&volume.set(c+1)}else c>=1&&volume.set(c+1);else l>=-2&&octaveShift.set(l-1);else l<=2&&octaveShift.set(l+1)},themeName:u}}class App extends SvelteComponent{constructor(e){super(),init(this,e,instance$b,create_fragment$b,safe_not_equal,[])}}const app=new App({target:document.body});return app}();
//# sourceMappingURL=bundle.js.map
